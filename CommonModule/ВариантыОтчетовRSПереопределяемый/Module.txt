////////////////////////////////////////////////////////////////////////////////
// ПРОГРАММНЫЙ ИНТЕРФЕЙС

// Определяет разделы, в которых доступна панель отчетов.
//
// Параметры:
//   Разделы (Массив) из (ОбъектМетаданных)
//
// Описание:
//   В Разделы необходимо добавить метаданные подсистем тех разделов,
//   в которых размещены команды вызова панелей отчетов.
//
// Например:
//	Разделы.Добавить(Метаданные.Подсистемы.ИмяПодсистемы);
//
Процедура ОпределитьРазделыСВариантамиОтчетов(Разделы) Экспорт
	
	Разделы.Добавить(Метаданные.Подсистемы.Администрирование);
	Разделы.Добавить(Метаданные.Подсистемы.ДенежныеСредства);
	Разделы.Добавить(Метаданные.Подсистемы.МаркетингИПродажи);
	Разделы.Добавить(Метаданные.Подсистемы.НормативноСправочнаяИнформация);
	Разделы.Добавить(Метаданные.Подсистемы.Производство);
	Разделы.Добавить(Метаданные.Подсистемы.СкладИЗапасы);
	Разделы.Добавить(Метаданные.Подсистемы.ТорговоеОборудование);
	
КонецПроцедуры

// Содержит настройки размещения вариантов отчетов в панели отчетов.
//
// Параметры:
//   Настройки (ДеревоЗначений) Используется для описания настроек отчетов и вариантов
//       см. описание к ВариантыОтчетов.ДеревоНастроекВариантовОтчетовКонфигурации()
//
// Описание:
//   В данной процедуре необходимо указать каким именно образом предопределенные варианты отчетов
//   будут регистрироваться в системе и показываться в панели отчетов.
//
// Вспомогательные функции:
//   Отчет = ВариантыОтчетов.ОписаниеОтчета(Настройки, Метаданные.Отчеты.<ИмяОтчета>);
//   Вариант = ВариантыОтчетов.ОписаниеВарианта(Настройки, Отчет, "<ИмяВарианта>");
//
//   Данные функции получают описание отчета или варианта отчета следующей структуры:
//       |- Включен (Булево)
//            Если Ложь, то вариант отчета не регистрируется в подсистеме.
//              Используется для удаления технических и контекстных вариантов отчетов из всех интерфейсов.
//              Эти варианты отчета по прежнему можно открывать в форме отчета программно при помощи
//              параметров открытия (см. справку по "Расширение управляемой формы для отчета.КлючВарианта").
//       |- ВидимостьПоУмолчанию (Булево)
//            Если Ложь, то вариант отчета по умолчанию скрыт в панели отчетов.
//              Пользователь может "включить" его в режиме настройки панели отчетов
//              или открыть через форму "Все отчеты".
//       |- Описание (Строка)
//            Дополнительная информация по варианту отчета.
//              В панели отчетов выводится в качестве подсказки.
//              Должно расшифровывать для пользователя содержимое варианта отчета
//              и не должно дублировать наименование варианта отчета.
//       |- Размещение (Соответствие) Настройки размещения варианта отчета в разделах
//           |- Ключ     (ОбъектМетаданных) Подсистема, в которой размещается отчет или вариант отчета
//           |- Значение (Строка)           Необязательный. Настройки размещения в подсистеме.
//               |- ""        - Выводить отчет в своей группе обычным шрифтом.
//               |- "Важный"  - Выводить отчет в своей группе жирным шрифтом.
//               |- "СмТакже" - Выводить отчет в группе "См. также".
//
// Например:
//
//  (1) Оставить в подсистеме только один из вариантов отчета
//	Отчет = ВариантыОтчетов.ОписаниеОтчета(Настройки, Метаданные.Отчеты.ИмяОтчета);
//	Отчет.Размещение.Удалить(Метаданные.Подсистемы.ИмяРаздела);
//	Вариант = ВариантыОтчетов.ОписаниеВарианта(Настройки, Отчет, "ИмяВарианта1");
//	Отчет.Размещение.Вставить(Метаданные.Подсистемы.ИмяРаздела);
//
//  (2) Отключить вариант отчета
//	Вариант = ВариантыОтчетов.ОписаниеВарианта(Настройки, Метаданные.Отчеты.ИмяОтчета, "ИмяВарианта1");
//	Вариант.Включен = Ложь;
//
//  (3) Отключить все варианты отчета, кроме требуемого
//	Отчет = ВариантыОтчетов.ОписаниеОтчета(Настройки, Метаданные.Отчеты.ИмяОтчета);
//	Отчет.Включен = Ложь;
//	Вариант = ВариантыОтчетов.ОписаниеВарианта(Настройки, Отчет, "ИмяВарианта");
//	Вариант.Включен = Истина;
//
//  (4) Результат исполнения любого из двух фрагментов кода будет одинаковым:
//	Отчет = ВариантыОтчетов.ОписаниеОтчета(Настройки, Метаданные.Отчеты.ИмяОтчета);
//	Вариант = ВариантыОтчетов.ОписаниеВарианта(Настройки, Отчет, "ИмяВарианта1");
//	Вариант.Размещение.Удалить(Метаданные.Подсистемы.ИмяРаздела.Подсистемы.ИмяПодсистемы);
//	Вариант = ВариантыОтчетов.ОписаниеВарианта(Настройки, Отчет, "ИмяВарианта2");
//	Вариант.Размещение.Удалить(Метаданные.Подсистемы.ИмяРаздела.Подсистемы.ИмяПодсистемы);
//	Вариант = ВариантыОтчетов.ОписаниеВарианта(Настройки, Отчет, "ИмяВарианта3");
//	Вариант.Размещение.Удалить(Метаданные.Подсистемы.ИмяРаздела.Подсистемы.ИмяПодсистемы);
//
//	Отчет = ВариантыОтчетов.ОписаниеОтчета(Настройки, Метаданные.Отчеты.ИмяОтчета);
//	Отчет.Размещение.Удалить(Метаданные.Подсистемы.ИмяРаздела.Подсистемы.ИмяПодсистемы);
//	Вариант = ВариантыОтчетов.ОписаниеВарианта(Настройки, Отчет, "ИмяВарианта1");
//	Вариант = ВариантыОтчетов.ОписаниеВарианта(Настройки, Отчет, "ИмяВарианта2");
//	Вариант = ВариантыОтчетов.ОписаниеВарианта(Настройки, Отчет, "ИмяВарианта3");
//	Отчет.Размещение.Вставить(Метаданные.Подсистемы.ИмяРаздела.Подсистемы.ИмяПодсистемы);
//
//
// Важно:
//   Начальная настройка размещения отчетов по разделам зачитывается из метаданных,
//   ее дублирование в коде не требуется.
//   
//   Настройки варианта имеют приоритет над настройками отчета.
//   
//   Настройки варианта при получении формируются из настроек отчета
//   и после получения не зависят от настроек отчета (становятся самостоятельными, см. примеры 3 и 4).
//
Процедура НастроитьВариантыОтчетов(Настройки) Экспорт
	
	ОтчетыСНетиповымиНастройками = ПолучитьИменаОтчетовСНетиповымиНастройками();
	Для Каждого ИмяОтчета Из ОтчетыСНетиповымиНастройками Цикл
		Отчеты[ИмяОтчета].НастроитьВариантыОтчета(
			Настройки,
 			ВариантыОтчетов.ОписаниеОтчета(
				Настройки, 
				Метаданные.Отчеты[ИмяОтчета]));
	КонецЦикла;
	
КонецПроцедуры 

// Содержит описания изменений имен вариантов отчетов. Используется
//   при обновлении информационной базы, в целях контроля ссылочной целостности
//   и для сохранения настроек варианта, сделанных администратором.
//
// Параметры:
//   Изменения (ТаблицаЗначений) Таблица изменений имен вариантов
//       |- Отчет (ОбъектМетаданных)
//       |- СтароеИмяВарианта (Строка)
//       |- АктуальноеИмяВарианта (Строка)
//
// Описание:
//   В Изменения необходимо добавить описания изменений имен вариантов
//   отчетов, подключенных к подсистеме.
//
// Например:
//	ДобавитьИзменениеКлючей(Изменения, "<ИмяОтчета>", "<СтароеИмяВарианта>", "<АктуальноеИмяВарианта>");
//
// Важно:
//   Старое имя варианта резервируется и не может быть использовано в дальнейшем.
//   Если изменений было несколько, то каждое изменение необходимо зарегистрировать,
//   указывая в актуальном имени варианта последнее (текущее) имя варианта отчета.
//   Поскольку имена вариантов отчетов не выводятся в пользовательском интерфейсе,
//   то рекомендуется задавать их таким образом, что бы затем не менять.
//
Процедура ЗарегистрироватьИзмененияКлючейВариантовОтчетов(Изменения) Экспорт
	
	ДобавитьИзменениеКлючей(Изменения, "АнализПоступленийРасходовТоваров", "АнализПоступленийТоваров", "СебестоимостьПоступившихТоваров");
	ДобавитьИзменениеКлючей(Изменения, "АнализПоступленийРасходовТоваров", "АнализРасходовТоваров", "СебестоимостьВыбывшихТоваров");
	ДобавитьИзменениеКлючей(Изменения, "АнализПоступленийРасходовТоваров", "АнализСписанийТоваров", "СебестоимостьСписанныхТоваров");
	ДобавитьИзменениеКлючей(Изменения, "ДебиторскаяЗадолженность", "ИнтервалыГоризонтально", "ДебиторскаяЗадолженность");
	ДобавитьИзменениеКлючей(Изменения, "ДебиторскаяЗадолженность", "ПоРасчетнымДокументам", "ДебиторскаяЗадолженностьПоРасчетнымДокументам");
	ДобавитьИзменениеКлючей(Изменения, "КредиторскаяЗадолженность", "ИнтервалыГоризонтально", "КредиторскаяЗадолженность");
	ДобавитьИзменениеКлючей(Изменения, "КредиторскаяЗадолженность", "ПоРасчетнымДокументам", "КредиторскаяЗадолженностьПоРасчетнымДокументам");
	ДобавитьИзменениеКлючей(Изменения, "ВедомостьПоТоварамОрганизацийВЦенахНоменклатуры", "Основной", "ВедомостьПоТоварамОрганизацийВЦенахНоменклатуры");
	ДобавитьИзменениеКлючей(Изменения, "ВыручкаИСебестоимостьПродаж", "ПродажиСписок", "ПродажиПоПартнерам");
	ДобавитьИзменениеКлючей(Изменения, "ВыручкаИСебестоимостьПродаж", "АнализПродажПоПоставщикам", "ПродажиПоПоставщикам");
	ДобавитьИзменениеКлючей(Изменения, "ВыручкаИСебестоимостьПродаж", "АнализПродажПоБизнесРегионамДиаграмма", "АнализПродажПоБизнесРегионам");
	ДобавитьИзменениеКлючей(Изменения, "ДинамикаПоказателейРаботыТорговыхПредставителей", "Основной", "ДинамикаПоказателейТорговыхПредставителей");
	ДобавитьИзменениеКлючей(Изменения, "КарточкаРасчетовСКлиентами", "Основной", "КарточкаРасчетовСКлиентами");
	ДобавитьИзменениеКлючей(Изменения, "КарточкаРасчетовСПоставщиками", "Основной", "КарточкаРасчетовСПоставщиками");
	ДобавитьИзменениеКлючей(Изменения, "ПланФактныйАнализРаботыТорговыхПредставителейПоКоличеству", 
		"ВыполнениеЗаданийПоКоличествуВРазрезеТорговыхПредставителей", "ВыполнениеЗаданийПоПредставителям");
	ДобавитьИзменениеКлючей(Изменения, "ПланФактныйАнализРаботыТорговыхПредставителейПоКоличеству", 
		"ВыполнениеЗаданийПоКоличествуВРазрезеНоменклатуры", "ВыполнениеЗаданийПоНоменклатуре");
	ДобавитьИзменениеКлючей(Изменения, "РаспределениеТорговыхПредставителей", "Основной", "КалендарьВизитовТорговыхПредставителей");
	ДобавитьИзменениеКлючей(Изменения, "СостояниеВыполненияЗаказовКлиентов", "Основной", "СостояниеВыполненияЗаказовКлиентов");
	ДобавитьИзменениеКлючей(Изменения, "СостояниеВыполненияЗаказовПоставщикам", "Основной", "СостояниеВыполненияЗаказовПоставщикам");
	ДобавитьИзменениеКлючей(Изменения, "СостояниеРасчетовСКлиентами", "Основной", "СостояниеРасчетовСКлиентами");
	ДобавитьИзменениеКлючей(Изменения, "СостояниеРасчетовСПоставщиками", "Основной", "СостояниеРасчетовСПоставщиками");
	ДобавитьИзменениеКлючей(Изменения, "ТоварныйКалендарь", "Основной", "ТоварныйКалендарь");
	
КонецПроцедуры

// Функция возвращает имена отчетов, для которых необходима нетиповая настройка размещения вариантов в панели отчетов.
// В модуле менеджера отчета должна быть объявлена экспортная процедура НастроитьВариантыОтчета.
//
// Возвращаемое значение:
//	Массив
//	  |- Строка - имя отчета
//
Функция ПолучитьИменаОтчетовСНетиповымиНастройками(ОтчетыСНетиповымиНастройками = Неопределено) Экспорт

	Если ОтчетыСНетиповымиНастройками = Неопределено Тогда
		ОтчетыСНетиповымиНастройками = Новый Массив;
	КонецЕсли;
	
	// Отчеты, полностью отключенные от механизма "Варианты отчетов" (по алфавиту)
	ОтчетыСНетиповымиНастройками.Добавить("ABCXYZРаспределениеКлиентов");
	ОтчетыСНетиповымиНастройками.Добавить("АнализОстатковТоваровОрганизаций");
	ОтчетыСНетиповымиНастройками.Добавить("АнализПричинОтменыЗаказовПоставщикамПоДокументу");
	ОтчетыСНетиповымиНастройками.Добавить("АнализРасхожденийПриПоступленииТоваров");
	ОтчетыСНетиповымиНастройками.Добавить("АнализЦенПоставщиков");
	ОтчетыСНетиповымиНастройками.Добавить("ДанныеАссортиментаНоменклатуры");
	ОтчетыСНетиповымиНастройками.Добавить("ДинамикаИзмененияЦенНоменклатуры");
	ОтчетыСНетиповымиНастройками.Добавить("ДинамикаИзмененияЦенНоменклатурыПоставщика");
	ОтчетыСНетиповымиНастройками.Добавить("ЗаблокированныеЯчейки");
	ОтчетыСНетиповымиНастройками.Добавить("ИзменениеABCXYZРаспределенияКлиентов");
	ОтчетыСНетиповымиНастройками.Добавить("КарточкаПартииПоВидамНалогообложения");
	ОтчетыСНетиповымиНастройками.Добавить("ОстаткиТоваровОрганизаций");
	ОтчетыСНетиповымиНастройками.Добавить("ПересеченияСегментаНоменклатуры");
	ОтчетыСНетиповымиНастройками.Добавить("ПересеченияСегментаПартнеров");
	ОтчетыСНетиповымиНастройками.Добавить("ПримененныеСкидкиВДокументе");
	ОтчетыСНетиповымиНастройками.Добавить("СоставПродажи");
	ОтчетыСНетиповымиНастройками.Добавить("СостояниеВыполненияЗаказовКлиентов");
	ОтчетыСНетиповымиНастройками.Добавить("СостояниеВыполненияЗаказовКлиентовСамообслуживание");
	ОтчетыСНетиповымиНастройками.Добавить("СостояниеВыполненияЗаказовПоставщикам");
	ОтчетыСНетиповымиНастройками.Добавить("СостояниеВыполненияЗаявокНаВозвратТоваровОтКлиентов");
	ОтчетыСНетиповымиНастройками.Добавить("РезультатыСогласованияЗакупки");
	ОтчетыСНетиповымиНастройками.Добавить("РезультатыСогласованияЗаявкиНаВозвратТоваровОтКлиента");
	ОтчетыСНетиповымиНастройками.Добавить("РезультатыСогласованияПродажи");
	ОтчетыСНетиповымиНастройками.Добавить("РезультатыСогласованияЦенНоменклатуры");
	ОтчетыСНетиповымиНастройками.Добавить("УправленческийБаланс");
	
	// Отчеты с индивидуальными настройками (по алфавиту)
	ОтчетыСНетиповымиНастройками.Добавить("ABCXYZАнализНоменклатуры");
	ОтчетыСНетиповымиНастройками.Добавить("АнализДвиженийДенежныхСредств");
	ОтчетыСНетиповымиНастройками.Добавить("АнализДоступностиТоваров");
	ОтчетыСНетиповымиНастройками.Добавить("АнализДоходовРасходов");
	ОтчетыСНетиповымиНастройками.Добавить("АнализИсполненияАссортимента");
	ОтчетыСНетиповымиНастройками.Добавить("АнализПоступленийРасходовТоваров");	
	ОтчетыСНетиповымиНастройками.Добавить("АнализПричинОтменыЗаказовКлиентов");
	ОтчетыСНетиповымиНастройками.Добавить("АнализСебестоимостиТоваров");
	ОтчетыСНетиповымиНастройками.Добавить("АнализСебестоимостиТоваровПоПоставщикам");
	ОтчетыСНетиповымиНастройками.Добавить("АнализФинансовыхРезультатов");
	ОтчетыСНетиповымиНастройками.Добавить("ВедомостьПоТоварамНаСкладах");
	ОтчетыСНетиповымиНастройками.Добавить("ВедомостьПоТоварамОрганизаций");
	ОтчетыСНетиповымиНастройками.Добавить("ВыручкаИСебестоимостьПродаж");
	ОтчетыСНетиповымиНастройками.Добавить("ВыручкаИСебестоимостьРозничныхПродаж");
	ОтчетыСНетиповымиНастройками.Добавить("ГрафикОплатНачисленийКредитовИДепозитов");
	ОтчетыСНетиповымиНастройками.Добавить("ДвиженияСерийТоваров");
	ОтчетыСНетиповымиНастройками.Добавить("ДебиторскаяЗадолженность");
	ОтчетыСНетиповымиНастройками.Добавить("ИндексыЦенПоставщиков");
	ОтчетыСНетиповымиНастройками.Добавить("КарточкаРасчетовСКлиентами");
	ОтчетыСНетиповымиНастройками.Добавить("КарточкаРасчетовСПоставщиками");
	ОтчетыСНетиповымиНастройками.Добавить("КонтактнаяИнформация");
	ОтчетыСНетиповымиНастройками.Добавить("КонтрольДенежныхСредств");
	ОтчетыСНетиповымиНастройками.Добавить("КонтрольНомеровГТДТоваров");
	ОтчетыСНетиповымиНастройками.Добавить("КредиторскаяЗадолженность");
	ОтчетыСНетиповымиНастройками.Добавить("НаличныеДенежныеСредства");
	ОтчетыСНетиповымиНастройками.Добавить("ОстаткиИДвиженияДенежныхСредств");
	ОтчетыСНетиповымиНастройками.Добавить("ОстаткиИДвиженияДенежныхСредствВКассахККМ");
	ОтчетыСНетиповымиНастройками.Добавить("ОстаткиТоваровПереданныхНаКомиссию");
	ОтчетыСНетиповымиНастройками.Добавить("ОстаткиТоваровПринятыхНаКомиссию");
	ОтчетыСНетиповымиНастройками.Добавить("ОформлениеИзлишковНедостачТоваров");
	ОтчетыСНетиповымиНастройками.Добавить("ОформлениеОтчетовКомитенту");
	ОтчетыСНетиповымиНастройками.Добавить("ПланФактныйАнализКредитовИДепозитов");
	ОтчетыСНетиповымиНастройками.Добавить("ПлатежныйКалендарь");
	ОтчетыСНетиповымиНастройками.Добавить("ПрайсЛист");
	ОтчетыСНетиповымиНастройками.Добавить("ПричиныЗапретаОтгрузки");
	ОтчетыСНетиповымиНастройками.Добавить("ПродажиСравнениеАналогичныхПериодов");
	ОтчетыСНетиповымиНастройками.Добавить("ПродажиСравнениеДвухПериодов");
	ОтчетыСНетиповымиНастройками.Добавить("РасчетыСКлиентами");
	ОтчетыСНетиповымиНастройками.Добавить("РасчетыСПартнерами");
	ОтчетыСНетиповымиНастройками.Добавить("РасчетыСПоставщиками");
	ОтчетыСНетиповымиНастройками.Добавить("СостояниеРасчетовСКлиентами");
	ОтчетыСНетиповымиНастройками.Добавить("СостояниеРасчетовСКомиссионерами");
	ОтчетыСНетиповымиНастройками.Добавить("СостояниеРасчетовСКомитентами");
	ОтчетыСНетиповымиНастройками.Добавить("СостояниеРасчетовСПоставщиками");
	ОтчетыСНетиповымиНастройками.Добавить("СправочноеРазмещениеНоменклатуры");
	ОтчетыСНетиповымиНастройками.Добавить("СравнениеГрафиковКредитовИДепозитов");
	ОтчетыСНетиповымиНастройками.Добавить("СравнительныйАнализДинамикиАссортиментаИПродаж");
	ОтчетыСНетиповымиНастройками.Добавить("ТоварныйКалендарь");
	ОтчетыСНетиповымиНастройками.Добавить("ТоварыВЯчейках");
	ОтчетыСНетиповымиНастройками.Добавить("ТоварыКОтгрузке");
	ОтчетыСНетиповымиНастройками.Добавить("ТоварыКПоступлению");
	ОтчетыСНетиповымиНастройками.Добавить("ТоварыНаСкладахПоСрокамГодности");
	ОтчетыСНетиповымиНастройками.Добавить("ТоварыПереданныеНаКомиссию");
	ОтчетыСНетиповымиНастройками.Добавить("ТоварыПринятыеНаКомиссию");
	ОтчетыСНетиповымиНастройками.Добавить("УсловияПродаж");

	Возврат ОтчетыСНетиповымиНастройками;
	
КонецФункции

// Содержит настройки размещения вариантов отчетов в панели отчетов.
//
// Параметры:
//   КлючОбъекта (Строка) Имя отчета в виде "Отчет.<ИмяОтчета>"
//
// Возвращаемое значение:
//	Строка - имя отчета без "Отчет."
//
Функция ИмяОтчетаПоКлючуОбъекта(КлючОбъекта) Экспорт
	Возврат СтрЗаменить(КлючОбъекта, "Отчет.", "");
КонецФункции

// Устанавливает важность для указанного варианта отчета в указанной подсистеме
//
// Параметры:
// 	ОписаниеОтчета - СтрокаДереваЗначений
//  Важность   - Строка
//               |- ""        - Вывод отчета в своей группе обычным шрифтом.
//               |- "Важный"  - Вывод отчета в своей группе жирным шрифтом.
//               |- "СмТакже" - Вывод отчета в группе "См. также".
//  Подсистема   - Метаданные.Подсистема - если подсистема не указана, то для всех подсистем варианта
//
Процедура УстановитьВажностьВариантаОтчета(ОписаниеВарианта, Важность, Подсистема = Неопределено) Экспорт
	
	Если ВажностьУказанаВерно(Важность) Тогда
		Размещение = ОписаниеВарианта.Размещение.Получить(Подсистема);
	
		Если Не Размещение = Неопределено Тогда
			ОписаниеВарианта.Размещение.Вставить(Подсистема, Важность);
		Иначе
			Для Каждого Размещение Из ОписаниеВарианта.Размещение Цикл 
				ОписаниеВарианта.Размещение.Вставить(Размещение.Ключ, Важность);
			КонецЦикла;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

// Отключает указанный отчет со всеми его вариантами от механизма "Варианты отчетов".
//
// Параметры:
// 	ОписаниеОтчета - СтрокаДереваЗначений
//
Процедура ОтключитьОтчет(ОписаниеОтчета) Экспорт
	
	ОписаниеОтчета.Включен = Ложь;
	
КонецПроцедуры

// Отключает указанный вариант отчета от механизма "Варианты отчетов".
//
// Параметры:
//	Настройки 	   - ДеревоЗначений
// 	ОписаниеОтчета - СтрокаДереваЗначений
//  КлючВарианта   - Строка
//
Процедура ОтключитьВариантОтчета(Настройки, ОписаниеОтчета, КлючВарианта) Экспорт
	
	ОписаниеВарианта = ВариантыОтчетов.ОписаниеВарианта(Настройки, ОписаниеОтчета, КлючВарианта);
	
	ОписаниеВарианта.Включен = Ложь;
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

// Проверяет строку на содержание параметров важности
//
// Параметры:
//  Важность   - (Строка)
//
// Возвращаемое значение: 
//  Булево   - Истина, если переданная строка равна одному из значений:
//               |- ""        - Вывод отчета в своей группе обычным шрифтом.
//               |- "Важный"  - Вывод отчета в своей группе жирным шрифтом.
//               |- "СмТакже" - Вывод отчета в группе "См. также".
//             Ложь, в ином случае
//
Функция ВажностьУказанаВерно(Важность)
	
	Возврат ПустаяСтрока(Важность) Или Важность = "Важный" Или Важность = "СмТакже";
	
КонецФункции

Процедура ДобавитьИзменениеКлючей(Изменения, ИмяОтчета, СтароеИмяВарианта, АктуальноеИмяВарианта)
	
	Изменение = Изменения.Добавить();
	
	Изменение.Отчет 				= Метаданные.Отчеты[ИмяОтчета];
	Изменение.СтароеИмяВарианта 	= СтароеИмяВарианта;
	Изменение.АктуальноеИмяВарианта = АктуальноеИмяВарианта;
	
КонецПроцедуры

