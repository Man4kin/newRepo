Функция ПолучитьКоличествоДней(НачалоПериода,КонецПериода) экспорт          
	Возврат Окр((КонецДня(КонецПериода)-НачалоДня(НачалоПериода))/(24*60*60));	
конецфункции

ФУнкция ПолучитьПериодПоставки(НачалоПериода,КонецПериода) экспорт
Возврат Формат(НачалоПериода,"ДФ=dd.MM.yyyy")+"-"+Формат(КонецПериода,"ДФ=dd.MM.yyyy");	
конецфункции

ФУнкция ПолучитьПредставлениеКоличества(Количество,ЕдИЗМ) экспорт
	Возврат ?(ЗначениеЗаполнено(Количество),""+Количество+" "+ЕдИзм,"");
конецфункции

Функция ПолучитьКодГруппы(Уровень,Код) экспорт
	Код = Формат(Код,"ЧГ=");
	Если Уровень = "V" Тогда
		Возврат "1:"+Код;
	ИначеЕсли Уровень = "G" Тогда
		Возврат "2:"+Код;
	ИначеЕсли Уровень = "D" Тогда
		Возврат "3:"+Код;
	Иначе
		Возврат Код;
	КонецЕсли;	
конецфункции

Функция ПолучитьУровень(Ссылка) экспорт
	Уровень = Ссылка.Уровень();
	Если Уровень = 0 Тогда
		Возврат "V";
	ИначеЕсли Уровень = 1 Тогда
		Возврат "G";
	ИначеЕсли Уровень = 2 Тогда
		Возврат "D";
	ИначеЕсли Уровень = 3 Тогда
		Возврат "C";
	Иначе
		Возврат "S";
	КонецЕсли;	
конецфункции


Функция ФорматНомера(Код) экспорт
	Возврат Формат(Код,"ЧГ=");
конецфункции

Функция ВозвратПараметраСеанса(Параметр) экспорт
	Возврат ПараметрыСеанса[Параметр];
конецфункции

Функция ВозвратРеквизитаПараметраСЕанса(ИмяПараметра,ИмяРеквизита) экспорт
	Возврат ПараметрыСеанса[ИмяПараметра][ИмяРеквизита];
КонецФункции

Функция ПолучитьКодТекущейСЕ() экспорт
	//Возврат "0";
	Возврат ПараметрыСеанса.ТекущаяСтруктурнаяЕдиница.Код;
конецфункции

Функция ПолучитьНаценку(Себестоимость,СуммаПродажи) экспорт
	Если Себестоимость = 0 Тогда
		Возврат "";
	Иначе	
		Возврат (СуммаПродажи-Себестоимость)*100/Себестоимость;
	КонецЕсли;
конецфункции

Функция ПолучитьКодUDA_LOV(КодТовара,КодUDA,ЗначениеUDA) экспорт
	Возврат КодТовара+"-"+СтрЗаменить(КодUDA,Символы.НПП,"")+"-"+СтрЗаменить(ЗначениеUDA,Символы.НПП,"");
конецфункции

Функция ПолучитьКодUDA(КодТовара,КодUDA,ЗначениеUDA) экспорт
	Возврат КодТовара+"-"+СтрЗаменить(КодUDA,Символы.НПП,"")+"-"+ЗначениеUDA;
конецфункции

Функция СКД_СокрлЛП(стрСтрока) экспорт
	
	Возврат СокрЛП(стрСтрока);
	
	
КонецФункции	

Функция ПолучитьСреднийЗапас(Номенклатура,КОличествоДней,НачалоПериода,КонецПериода) экспорт
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	               |	ОстаткиНоменклатурыОстаткиИОбороты.КоличествоКонечныйОстаток КАК Остаток,
	               |	ОстаткиНоменклатурыОстаткиИОбороты.Период КАК Период
	               |ИЗ
	               |	РегистрНакопления.ОстаткиНоменклатуры.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, День, , Номенклатура В ИЕРАРХИИ (&Номенклатура)) КАК ОстаткиНоменклатурыОстаткиИОбороты
	               |ИТОГИ
	               |	СУММА(Остаток)
	               |ПО
	               |	Период ПЕРИОДАМИ(ДЕНЬ, , )";
	Запрос.УстановитьПараметр("Номенклатура",Номенклатура);
	ЗАпрос.УстановитьПараметр("НачалоПериода",НачалоПЕриода);
	Запрос.УстановитьПараметр("КонецПериода",КонецПериода);
	Рез = Запрос.Выполнить();
	Выборка = Рез.Выбрать();
	Сумма = 0;
	Пока Выборка.Следующий() Цикл
		если Выборка.Период = НачалоДня(НачалоПериода) или выборка.Период = НачалоДня(КонецПериода) тогда
		сумма = сумма + Выборка.Остаток/2;
	Иначе
		Сумма = сумма + Выборка.Остаток;
		КонецЕсли;
	КонецЦикла;
	СреднийЗапас = сумма/(КоличествоДней-1);
	Возврат СреднийЗапас;
КонецФункции

Функция ПолучитьСреднийЗапасСУмма(Номенклатура,КОличествоДней,НачалоПериода,КонецПериода) Экспорт
		Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	               |	ОстаткиНоменклатурыОстаткиИОбороты.СуммаКонечныйОстаток КАК Остаток,
	               |	ОстаткиНоменклатурыОстаткиИОбороты.Период КАК Период
	               |ИЗ
	               |	РегистрНакопления.ОстаткиНоменклатуры.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, День, , Номенклатура В ИЕРАРХИИ (&Номенклатура)) КАК ОстаткиНоменклатурыОстаткиИОбороты
	               |ИТОГИ
	               |	СУММА(Остаток)
	               |ПО
	               |	Период ПЕРИОДАМИ(ДЕНЬ, , )";
	Запрос.УстановитьПараметр("Номенклатура",Номенклатура);
	ЗАпрос.УстановитьПараметр("НачалоПериода",НачалоПЕриода);
	Запрос.УстановитьПараметр("КонецПериода",КонецПериода);
	Рез = Запрос.Выполнить();
	Выборка = Рез.Выбрать();
	Сумма = 0;
	Пока Выборка.Следующий() Цикл
		если Выборка.Период = НачалоДня(НачалоПериода) или выборка.Период = НачалоДня(КонецПериода) тогда
		сумма = сумма + Выборка.Остаток/2;
	Иначе
		Сумма = сумма + Выборка.Остаток;
		КонецЕсли;
	КонецЦикла;
	СреднийЗапас = сумма/(КоличествоДней-1);
	Возврат СреднийЗапас;
КонецФункции

// bros+
функция ПолучитьКодКонтрагентаИзНаименованияUDA(СтрНаименование) экспорт
	
	Позиция = Найти(СтрНаименование,"_");
	
	если Позиция > 0 тогда
		Код = Сред(СтрНаименование,Позиция+1,СтрДлина(СтрНаименование)-Позиция);
		попытка
			КодЧисло = Число(Код);
		исключение
			КодЧисло = 0;
		конецпопытки;	
	иначе
		КодЧисло = 0;
	конецесли;	
	
	возврат КодЧисло;
	
конецфункции	
	
// bros-	