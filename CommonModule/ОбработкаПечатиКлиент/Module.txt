//////////////////////////////////////////////////////////////////////////////// 
// ЭКСПОРТНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ 
//

// ПРОЦЕДУРЫ И ФУНКЦИИ ФОРМИРОВАНИЯ ПЕЧАТНЫХ ФОРМ

// Выводит на печать подготовленный макет.
//
// Параметры:
//  ПечДокумент  - ТабличыйДокумент, макет на печать
//  КоличествоЭкземпляров  - Число, количество экземпляров на печать
//  НаПринтер    - Булево, Если истина, то выводим сразу на принтер
//  Заголовок    - Заголовок окна табличного документа
//  НепосредственнаяПечать - Булево, используется только для режима
//                 непосредственной печати.
//
Процедура НапечататьДокумент(ПечДокумент, КоличествоЭкземпляров = 1, НаПринтер = Ложь, Заголовок = "", НепосредственнаяПечать = Ложь) Экспорт

	Если ПечДокумент = Неопределено тогда
		Возврат;
	КонецЕсли;

	// Получить необходимое количество копий
	Если КоличествоЭкземпляров > 0 Тогда
		ПечДокумент.КоличествоЭкземпляров = КоличествоЭкземпляров;
	КонецЕсли;

	Если НЕ ПечДокумент.АвтоМасштаб
	   И НЕ ЗначениеЗаполнено(ПечДокумент.ИмяПринтера) Тогда
		ПечДокумент.АвтоМасштаб = Истина;
	КонецЕсли;

	Если НаПринтер Тогда
        ПечДокумент.Напечатать(НепосредственнаяПечать = Истина);
    Иначе
    	// Отобразить печатный документ на экране
		ПечДокумент.ОтображатьЗаголовки = Ложь;
		ПечДокумент.ОтображатьСетку     = Ложь;
		ПечДокумент.Защита              = Ложь;
		ПечДокумент.ТолькоПросмотр      = Истина;
        ПечДокумент.Показать(Заголовок);
	КонецЕсли;

КонецПроцедуры // НапечататьДокумент()
