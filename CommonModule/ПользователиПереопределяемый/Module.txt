

// Функция ЗапретРедактированияРолей используется для
// управления поведением подсистем Пользователи и ВнешниеПользователи,
// когда требуется переключится в режим автоустановки ролей пользователей ИБ,
// например, при встраивании подсистемы УправлениеДоступом.
//
// Возвращаемое значение:
//  Булево.
//
Функция ЗапретРедактированияРолей() Экспорт
	//popn+
	//Возврат Ложь;
	Возврат Истина;
	//popn-
КонецФункции

//popn+
Функция ПользовательУчаствуетВГруппеДоступа(Пользователь) Экспорт
	
	//если результат запроса пустой, значит данный пользователь не участвуюет в группах доступа
	//и как следствие мы можем ему разрешить править роли вручную
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ПользователиИГруппыПользователей.ЗначениеДоступа,
		|	ПользователиИГруппыПользователей.ГруппаДоступа
		|ИЗ
		|	РегистрСведений.ПользователиГруппыДоступа КАК ПользователиГруппыДоступа
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ГруппыЗначенийДоступа КАК ПользователиИГруппыПользователей
		|		ПО (ПользователиИГруппыПользователей.ВидДоступа В (ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыДоступа.Пользователи)))
		|			И (ПользователиИГруппыПользователей.ТолькоВидДоступа = ЛОЖЬ)
		|			И ПользователиГруппыДоступа.Пользователь = ПользователиИГруппыПользователей.ГруппаДоступа
		|			И (ТИПЗНАЧЕНИЯ(ПользователиИГруппыПользователей.ЗначениеДоступа) = ТИП(Справочник.Пользователи))
		|ГДЕ
		|	ПользователиИГруппыПользователей.ЗначениеДоступа = &Пользователь";

	Запрос.УстановитьПараметр("Пользователь", Пользователь);
	Результат = Запрос.Выполнить();

    Возврат НЕ Результат.Пустой();
	
КонецФункции
//popn-

// Процедура ИзменитьДействияВФорме позволяет переопределить
// поведение форм пользователя, внешнего пользователя, группы внешних пользователей
// когда это требуется, например, при встараивании подсистемы "Управление доступом".
//
// Параметры:
//  Ссылка - СправочникСсылка.Пользователи,
//           СправочникСсылка.ВнешниеПользователи,
//           СправочникСсылка.ГруппыВнешнихПользователей
//           ссылка на пользователя, внешнего пользователя или группу внешних пользователей
//           при создании формы.
//
//  ДействияВФорме - Структура (со свойствами типа Строка):
//           Роли                   = "", "Просмотр",     "Редактирование"
//           КонтактнаяИнформация   = "", "Просмотр",     "Редактирование"
//           СвойстваПользователяИБ = "", "ПросмотрВсех", "РедактированиеВсех", РедактированиеСвоих"
//           СвойстваЭлемента       = "", "Просмотр",     "Редактирование"
//           
//           Для групп внешних пользователей КонтактнаяИнформация и СвойстваПользователяИБ не существуют.
//
Процедура ИзменитьДействияВФорме(Знач Ссылка = Неопределено, Знач ДействияВФорме) Экспорт
	
КонецПроцедуры

// Обработчик события ПриЗаписи пользователя информационной базы
// вызывается из процедуры ЗаписатьПользователяИБ(), если пользователь
// был действительно записан.
//
// Параметры:
//  СтарыеСвойства - Структура, см. параметры возвращаемые функцией Пользователи.ПрочитатьПользователяИБ()
//  НовыеСвойства  - Структура, см. параметры возвращаемые функцией Пользователи.ЗаписатьПользователяИБ()
//
Процедура ПриЗаписиПользователяИнформационнойБазы(Знач СтарыеСвойства, Знач НовыеСвойства) Экспорт
	
КонецПроцедуры

// Обработчик события ПослеУдаления пользователя информационной базы
// вызывается из процедуры УдалитьПользователяИБ(), если пользователь
// был действительно удален.
//
// Параметры:
//  СтарыеСвойства - Структура, см. параметры возвращаемые функцией Пользователи.ПрочитатьПользователяИБ()
//
Процедура ПослеУдаленияПользователяИнформационнойБазы(Знач СтарыеСвойства) Экспорт
	
	
	
КонецПроцедуры

