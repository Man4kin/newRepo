&НаКлиенте
Процедура Инициализировать(глхлПечатьЭтикеток)  Экспорт
	Если глхлПечатьЭтикеток = Неопределено Тогда
		Попытка
			ПодключитьВнешнююКомпоненту("HeadLine.ThermalPrinter");
			глхлПечатьЭтикеток =  new COMОбъект("hl_ThermalPrinter");
		Исключение
			МенеджерОборудованияКлиент.УстановитьДрайверИзДистрибутива("Headline_ThermoPrinter", "setup.exe");
			ПодключитьВнешнююКомпоненту("HeadLine.ThermalPrinter");
			глхлПечатьЭтикеток =  new COMОбъект("hl_ThermalPrinter");
		КонецПопытки;
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура Печать(глхлПечатьЭтикеток,ИмяПринтера, ПечатныйМакетxml, ДанныеЗаполнения, КоличествоКопий = 1) Экспорт
	Если 1 = 2 тогда
		ДанныеЗаполнения = новый Структура;
	КонецЕсли;
	СловарьПараметров = глхлПечатьЭтикеток.MakeParmDict();
	Для Каждого стр из ДанныеЗаполнения Цикл
		СловарьПараметров.Add(стр.Ключ, стр.Значение);
	КонецЦикла;
	глхлПечатьЭтикеток.PrintXmlEPL(ИмяПринтера, ПечатныйМакетxml, СловарьПараметров, КоличествоКопий);
КонецПроцедуры

&НаКлиенте
Функция ПолучитьСписокПринтеров(глхлПечатьЭтикеток) Экспорт
	возврат глхлПечатьЭтикеток.GetPrinterList().Выгрузить(); 
КонецФункции

