// ----------------------------------------------------------------------------
// ----------------------------------------------------------------------------
// ОБРАБОТЧИКИ СОБЫТИЙ СВЯЗАННЫХ С ТАБЛИЦЕЙ КОНТАКТНОЙ ИНФОРМАЦИИ НА ФОРМАХ

// Событие ПередУдалением в таблице контактной информации
Процедура КонтактнаяИнформацияПередУдалением(Модифицированность, Отказ, ТекущиеДанные) Экспорт
	
	Модифицированность = Истина;
	Если Не ТекущиеДанные.ПометкаУдаления Тогда
		ОчиститьЗаписьКонтактнойИнформации(ТекущиеДанные);
		Отказ = Истина;
	КонецЕсли;
	
КонецПроцедуры

// Событие ПриИзменении в колонке Представление таблицы контактной информации
Процедура ПредставлениеПриИзменении(Модифицированность, ТекущиеДанные) Экспорт
	Модифицированность = Истина;
	Тип = ТекущиеДанные.Тип;
КонецПроцедуры

// Событие НачалоВыбора в колонке Представление таблицы контактной информации
Процедура ПредставлениеНачалоВыбора(Модифицированность, СтандартнаяОбработка, ТекущиеДанные) Экспорт
	
	СтандартнаяОбработка = Ложь;
	ВыполнитьРедактированиеЗначенияКонтактнойИнформации(Модифицированность, ТекущиеДанные);
	
КонецПроцедуры

// Событие Очистка в колонке Представление таблицы контактной информации
Процедура ПредставлениеОчистка(Модифицированность, ТекущиеДанные) Экспорт
	
	ОчиститьЗаписьКонтактнойИнформации(ТекущиеДанные);
	Модифицированность = Истина;
	
КонецПроцедуры


// ----------------------------------------------------------------------------
// ----------------------------------------------------------------------------
// СЛУЖЕБНЫЕ

// Очистить запись о контактной информации
Процедура ОчиститьЗаписьКонтактнойИнформации(текСтр)
	
	текСтр.Представление = "";
	текСтр.ЗначенияПолей.Очистить();
	
КонецПроцедуры

// Выполнить редактирование контактной информации в форме ввода
Процедура ВыполнитьРедактированиеЗначенияКонтактнойИнформации(Модифицированность, ТекущиеДанные)
		Возврат;
	Тип = ТекущиеДанные.Тип;
	Если Тип = ПредопределенноеЗначение("Перечисление.ТипыКонтактнойИнформации.Адрес") Тогда
		ИмяФормыРедактирования =  "ОбщаяФорма.ФормаРедактированияАдреса";
	ИначеЕсли (Тип = ПредопределенноеЗначение("Перечисление.ТипыКонтактнойИнформации.Телефон"))
		ИЛИ (Тип = ПредопределенноеЗначение("Перечисление.ТипыКонтактнойИнформации.Факс")) Тогда
		ИмяФормыРедактирования =  "ОбщаяФорма.ФормаРедактированияТелефона";
	Иначе
		Возврат;
	КонецЕсли;
	
	Пар = Новый Структура;
	Пар.Вставить("ЗначенияПолей",                ТекущиеДанные.ЗначенияПолей);
	Пар.Вставить("Вид",                          ТекущиеДанные.Вид);
	Пар.Вставить("БылиВнесеныИзменения",         Ложь);
	Пар.Вставить("Представление",                ТекущиеДанные.Представление);
	
	Форма = ПолучитьФорму(ИмяФормыРедактирования, Пар);
	Форма.ОткрытьМодально();
	
	Если Форма.Параметры.БылиВнесеныИзменения Тогда
		ТекущиеДанные.Представление = Форма.Параметры.Представление;
		ТекущиеДанные.ЗначенияПолей = Форма.Параметры.ЗначенияПолей;
		Модифицированность = Истина;
	КонецЕсли;
	
КонецПроцедуры

