	ФУнкция ПечатьНакладная(МассивОбъектов,ОбъектыПечати) экспорт
		для каждого док из массивобъектов цикл
			ТабДОК = Новый ТабличныйДокумент;
			Макет = УправлениеПечатью.ПолучитьМакет("Документ.Zотчет.Накладная");
			Область = Макет.ПолучитьОбласть("Заголовок");
			Область.Параметры.Дата =Формат(Док.Ссылка.Дата, "ДФ=dd.MM.yyyy");
			Область.Параметры.Номер = Док.Ссылка.Номер;
			Область.параметры.СтруктурнаяЕДиница = Док.Ссылка.СтруктурнаяЕдиница;
			Область.Параметры.Фирма = Док.Ссылка.Фирма;
			ШтрихкодированиеПечатныхФорм.ВывестиШтрихкодВТабличныйДокумент(ТабДок, Макет, Область, Док);
			ТабДок.Вывести(Область);
			Запрос = новый Запрос;
			Запрос.Текст = "ВЫБРАТЬ
			|	ZотчетВыручка.ПОС,
			|	ZотчетВыручка.Смена,
			|	ZотчетВыручка.ДатаСмены,
			|	ZотчетВыручка.Сумма
			|ИЗ
			|	Документ.Zотчет.Выручка КАК ZотчетВыручка
			|ГДЕ
			|	ZотчетВыручка.Ссылка = &Ссылка
			|
			|УПОРЯДОЧИТЬ ПО
			|	ZотчетВыручка.НомерСтроки";
			Запрос.УстановитьПараметр("Ссылка",Док.Ссылка);
			Рез = Запрос.Выполнить();
			ВЫборка = Рез.Выбрать();
			Если Выборка.Количество() тогда
				Область = Макет.Получитьобласть("ШапкаВЫручки");
				ТабДок.Вывести(Область);
			Конецесли;
			ПОка Выборка.Следующий() цикл
				Область = Макет.ПОлучитьОбласть("СтрокаВыручки");
				Область.параметры.ПОс = ВЫборка.Пос;
				Область.Параметры.Смена = Выборка.смена;
				Область.параметры.ДатаСмены = Формат(Выборка.ДатаСмены, "ДФ=dd.MM.yyyy");
				Область.параметры.Сумма = Выборка.сумма;
				ТабДок.Вывести(Область);
			КонецЦикла;
			Запрос = новый Запрос;
			Запрос.Текст = "ВЫБРАТЬ
			|	ZотчетСостав.Номенклатура,
			|	ZотчетСостав.ЕдиницаИзмерения,
			|	ZотчетСостав.Склад,
			|	ZотчетСостав.Сумма КАК Всего
			|ИЗ
			|	Документ.Zотчет.Состав КАК ZотчетСостав   где ZотчетСостав.Ссылка = &Ссылка
			|
			|УПОРЯДОЧИТЬ ПО
			|	ZотчетСостав.НомерСтроки   ";
			Запрос.УстановитьПараметр("Ссылка",Док.Ссылка);
			Рез = Запрос.Выполнить();
			ВЫборка = Рез.Выбрать();
			Если Выборка.Количество() тогда
				Область = Макет.получитьОбласть("ШапкаСостава");
				ТабДок.Вывести(Область);
			Конецесли;
			Пока	Выборка.Следующий() цикл
				Область = Макет.получитьОбласть("СтрокаСостава");
				Область.параметры.Номенклатура  = Выборка.Номенклатура;
				Область.параметры.Склад = Выборка.склад;
				Область.параметры.ЕдиницаИзмерения  =ВЫборка.ЕдиницаИзмерения;
				Область.параметры.Всего  = ВЫборка.всего;
				ТабДок.Вывести(Область);
			Конеццикла;
			Запрос = новый Запрос;
			Запрос.Текст = "ВЫБРАТЬ
			|	ZотчетКарты.ТипКарты,
			|	ZотчетКарты.Сумма КАК Сумма,
			|	ZотчетКарты.НомерСтроки КАК НомерСтроки
			|ИЗ
			|	Документ.Zотчет.Карты КАК ZотчетКарты
			|ГДЕ
			|	ZотчетКарты.Ссылка = &Ссылка
			|
			|УПОРЯДОЧИТЬ ПО
			|	НомерСтроки";
			Запрос.УстановитьПараметр("Ссылка",Док.Ссылка);
			Рез = Запрос.Выполнить();
			ВЫборка = Рез.Выбрать();
			Если Выборка.Количество() >0 тогда
				Область = Макет.получитьОбласть("ШапкаКарты");
				ТабДок.Вывести(Область);
			Конецесли;
			Пока ВЫборка.следующий() цикл
				Область = Макет.ПолучитьОбласть("СТрокаКарты");
				Область.параметры.ТипКарты  = ВЫборка.ТипКарты;
				Область.параметры.Сумма  = ВЫборка.сумма;
				ТабДок.Вывести(Область);
			Конеццикла;
		конеццикла;
		Возврат ТабДок;
	Конецфункции
	Функция ПолучитьЗапросПоШапке(Док)
		ЗапросПоШапка = новый Запрос;
		ЗапросПоШапка.текст = "ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Zотчет.СтруктурнаяЕдиница,
		|	Zотчет.Фирма.ИНН КАК ИНН,
		|	Zотчет.Фирма,
		|	Zотчет.Номер КАК НомерДокумента,
		|	Zотчет.Дата КАК ДатаДокумента
		|ИЗ
		|	Документ.Zотчет КАК Zотчет
		|ГДЕ
		|	Zотчет.Ссылка = &Ссылка";
		ЗапросПоШапка.УстановитьПараметр("Ссылка",Док.Ссылка);
		ЗапросПоШапка.УстановитьПараметр("НаДату",Новый Граница(Док.ссылка.МоментВремени(),ВидГраницы.Включая));
		Возврат ЗапросПоШапка;
	КонецФункции
	
	Функция ПолучитьЗапросПоТабЧасти(Док)
		ЗапросПоТабЧасть = Новый Запрос;
		ЗапросПоТабЧасть.Текст = "ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ZотчетВыручка.сумма КАК Выручка,
		|	ZотчетВыручка.ПОс.НомерПроизводителя КАК НомерПроизводителя,
		|	ZотчетВыручка.ПОс.НомерРегистрационный КАК НомерРегистрационный,
		|	ZотчетВыручка.ПОс КАК НомерПОС,
		|	ДенежныеСредстваОстаткиНаКонец.СуммаОстаток КАК ОстатокНаКонец,
		|	ДенежныеСредстваОстаткиНаНачало.СуммаОстаток КАК ОстатокНаНачало
		|ИЗ
		|	(ВЫБРАТЬ
		|		СУММА(ZотчетВыручка.Сумма) КАК сумма,
		|		ZотчетВыручка.Ссылка КАК Ссылка,
		|		ZотчетВыручка.ПОС КАК ПОс
		|	ИЗ
		|		Документ.Zотчет.Выручка КАК ZотчетВыручка
		|	
		|	СГРУППИРОВАТЬ ПО
		|		ZотчетВыручка.Ссылка,
		|		ZотчетВыручка.ПОС) КАК ZотчетВыручка
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДенежныеСредства.Остатки(
		|				&НаНачало,
		|				ДенежнаяЯчейка В
		|					(ВЫБРАТЬ РАЗЛИЧНЫЕ
		|						ZотчетВыручка.ПОС
		|					ИЗ
		|						Документ.Zотчет.Выручка КАК ZотчетВыручка
		|					ГДЕ
		|						ZотчетВыручка.Ссылка.Ссылка = &Ссылка)) КАК ДенежныеСредстваОстаткиНаНачало
		|		ПО ZотчетВыручка.ПОс = ДенежныеСредстваОстаткиНаНачало.ДенежнаяЯчейка
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ДенежныеСредства.Остатки(
		|				&НаКонец,
		|				ДенежнаяЯчейка В
		|					(ВЫБРАТЬ РАЗЛИЧНЫЕ
		|						ZотчетВыручка.ПОС
		|					ИЗ
		|						Документ.Zотчет.Выручка КАК ZотчетВыручка
		|					ГДЕ
		|						ZотчетВыручка.Ссылка.Ссылка = &Ссылка)) КАК ДенежныеСредстваОстаткиНаКонец
		|		ПО ZотчетВыручка.ПОс = ДенежныеСредстваОстаткиНаКонец.ДенежнаяЯчейка
		|ГДЕ
		|	ZотчетВыручка.Ссылка = &Ссылка
		|ИТОГИ
		|	СУММА(Выручка)
		|ПО
		|	ОБЩИЕ";
		
		ЗапросПоТабЧасть.УстановитьПараметр("Ссылка",Док.Ссылка);
		ЗапросПоТабЧасть.установитьПараметр("НаНачало",Новый Граница(Док.ссылка.МоментВремени(),ВидГраницы.Исключая));
		ЗапросПоТабЧасть.установитьПараметр("НаКонец",Новый Граница(Док.ссылка.МоментВремени(),ВидГраницы.Включая));
		
		Возврат ЗапроспоТабЧасть;	
	Конецфункции
	
	
	Функция ПечатьКМ7(МассивОбъектов,ОбъектыПечати) экспорт
		ТабДокумент = Новый ТабличныйДокумент;
		Макет = УправлениеПечатью.ПолучитьМакет("Документ.Zотчет.КМ7");
		НомерСтрокиНачало = 0;
		для каждого док из массивобъектов цикл	
			ЗапросПоШапка = ПолучитьЗапроспоШапке(Док);
			Результат = ЗапросПоШапка.выполнить();
			Выборка = Результат.Выбрать();
			Выборка.Следующий();
			СтрИнформацииОбОрганизации = ОбработкаПечатиСервер.СведенияОЮрФизЛице(Выборка.Фирма, Выборка.ДатаДокумента, Выборка.СтруктурнаяЕдиница);
			ФактическийАдрес = "";
			Телефон = "";
			Если СтрИнформацииОбОрганизации <> Неопределено и ТипЗнч(СтрИнформацииОбОрганизации) = Тип("Структура") тогда
				Значение = неопределено;
				СтрИнформацииОбОрганизации.Свойство("ПочтовыйАдрес",Значение);
				Если Значение<>Неопределено тогда
					ФактическийАдрес = Значение;
				Конецесли;
				СтрИнформацииОбОрганизации.свойство("Телефоны",Значение);
				Если Значение <> Неопределено тогда
					Телефон = значение;
				Конецесли;
			Конецесли;
			ОбластьЗаголовка = Макет.ПолучитьОбласть("Заголовок");
			
			ЗаполнитьЗначенияСвойств(Областьзаголовка.Параметры,Выборка);
			Областьзаголовка.Параметры.ДатаДокумента  = Формат(Выборка.ДатаДокумента,"ДЛФ=D");
			ОбластьЗаголовка.Параметры.ВремяДокумента = Формат(Выборка.ДатаДокумента,"ДЛФ=T");
			ЗнчФирма = Выборка.Фирма;
			//+Зернятко А.В.@06.11.2013 - //AKB-374. Ответственные лица СЕ
			ЗнчСЕ = Выборка.СтруктурнаяЕдиница;
			///Зернятко А.В.@ - конец блока
			
			ОбластьЗаголовка.Параметры.СведенияОбОрганизации = ""+ЗнчФирма.ПолноеНаименование+", "+ФАктическийАдрес+", "+Телефон;
			ТабДокумент.вывести(ОбластьЗаголовка);
			
			ОбластьШапки = Макет.ПолучитьОбласть("Шапка");
			ТабДокумент.ВЫвести(Областьшапки);
			ЗапросПоТабЧасть = ПолучитьЗапросПоТабЧасти(Док);
			Результат = ЗапросПоТабЧасть.Выполнить();
			ВыборкаОбИтоги = Результат.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			
			ОбластьСтрока = Макет.ПолучитьОбласть("Строка");
			Пока ВыборкаОбИтоги.Следующий() цикл
				Выборка = ВыборкаОбИтоги.Выбрать();
				Пока Выборка.Следующий() Цикл
					ЗаполнитьЗначенияСвойств(ОбластьСтрока.Параметры,Выборка);
					ТабДокумент.вывести(ОбластьСтрока);		
					
				КонецЦикла;
				ИтогоВыручка = ВыборкаОбИтоги.Выручка;	
				
			Конеццикла;
			ОбластьПодвал = Макет.получитьОбласть("Подвал");
			ОбластьПодвал.Параметры.ИтогоВыручка = ИтогоВыручка;
			//*Зернятко А.В.@06.11.2013 - //AKB-374. Ответственные лица СЕ
			//Руководители = обработкаПечатиСервер.ОтветственныеЛицаОрганизационнойЕдиницы(ЗнчФирма, Док.Дата);
			Руководители = обработкаПечатиСервер.ОтветственныеЛицаОрганизационнойЕдиницы(ЗнчФирма, Док.Дата, ЗнчСЕ);
			///Зернятко А.В.@ - конец блока
			РуководительФИО = Руководители.ФИОРуководителя;	
			РуководительДолжность = Руководители.РуководительДолжность;
			ОбластьПодвал.Параметры.РуководительФИО = РуководительФИО;
			ОбластьПодвал.Параметры.ДолжностьРуководителя = РуководительДолжность;
			ТабДокумент.вывести(ОбластьПодвал);
			УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабДокумент, 
			НомерСтрокиНачало, ОбъектыПечати,Док.Ссылка);
			НомерСтрокиНачало = ТабДокумент.ВысотаТаблицы+1;
		Конеццикла;
		Возврат ТабДокумент;
	КонецФункции
	
	Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм,
		ОбъектыПечати, ПараметрыВывода) Экспорт
		ПараметрыВывода.ДоступнаПечатьПоКомплектно = Истина;
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "Накладная") Тогда
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
			"Накладная", "Накладная",ПечатьНакладная(массивОбъектов,ОбъектыПечати));
		ИначеЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "КМ7") Тогда
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
			"КМ7", "КМ-7",ПечатьКМ7(массивОбъектов,ОбъектыПечати));
		КонецЕсли;
	КонецПроцедуры
	
	Функция ПолучитьСтруктуруПечатныхФорм(Док) Экспорт
		
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ОсновныеПечатныеФормыДокументов.ВидДокумента,
		|	ОсновныеПечатныеФормыДокументов.ИмяПечатнойФормы
		|ИЗ
		|	РегистрСведений.ОсновныеПечатныеФормыДокументов КАК ОсновныеПечатныеФормыДокументов
		|ГДЕ
		|	ОсновныеПечатныеФормыДокументов.ВидДокумента = &ВидДокумента";
		
		Запрос.УстановитьПараметр("ВидДокумента", Док.Метаданные().Имя);
		Результат = Запрос.Выполнить();
		
		ВыборкаДетальныеЗаписи = Результат.Выбрать();
		СтруктураПечФорм = Новый Структура;
		
		Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
			ИмяПечатнойФормы = ВыборкаДетальныеЗаписи.ИмяПечатнойФормы;
			МассивОбъектов = Новый Массив();
			МассивОбъектов.Добавить(Док.Ссылка);
			ОбъектыПечати = Новый СписокЗначений;
			ИмяФункцииПечати = "Печать"+СокрЛП(ИмяПечатнойФормы)+"(МассивОбъектов,ОбъектыПечати)";
			МакетПечатнойФормы = Вычислить(ИмяФункцииПечати);
			СтруктураПечФорм.Вставить(ИмяПечатнойФормы,МакетПечатнойФормы);
		КонецЦикла;
		
		Возврат СтруктураПечФорм;
		
	КонецФункции
	
