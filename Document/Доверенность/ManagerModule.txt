ФУнкция ПечатьМ2(МассивОбъектов,ОбъектыПечати) экспорт
	ТабДокумент = Новый ТабличныйДокумент;
	ТабДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_Доверенность_М2";
	НомерСтрокиНачало = 0;
	для каждого док из массивобъектов цикл
		//СотрудникФИО=ОмРаботаСФормами.ПолучитьФИОФизЛица(Сотрудник, Шапка.ДатаДокумента);
		СотрудникФИО = "";
		//Макет = ПолучитьМакет("М2");
		Макет = УправлениеПечатью.ПолучитьМакет("Документ.Доверенность.М2");

		Запрос = Новый Запрос();
		Запрос.УстановитьПараметр("ТекущийДокумент",  Док.Ссылка);
		Запрос.УстановитьПараметр("ДатаСреза",        Док.Дата);
		Запрос.УстановитьПараметр("Сотрудник",          Док.Сотрудник.Ссылка);
		Запрос.УстановитьПараметр("ПустаяХарактеристика", Справочники.ХарактеристикиНоменклатуры.ПустаяСсылка());
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	Доверенность.Номер КАК НомерДокумента,
		|	Доверенность.Дата КАК ДатаДокумента,
		|	Доверенность.Фирма КАК Руководители,
		|	Доверенность.Фирма,
		|	Доверенность.Сотрудник,
		|	Доверенность.Контрагент КАК Поставщик,
		|	Доверенность.БанковскийСчет КАК БанковскийСчет,
		|	ВЫБОР
		|		КОГДА (ВЫРАЗИТЬ(Доверенность.НаПолучениеОт КАК СТРОКА(100))) = """"
		|			ТОГДА Доверенность.Контрагент.Наименование
		|		ИНАЧЕ Доверенность.НаПолучениеОт
		|	КОНЕЦ КАК ПоставщикПредставление,
		|	Доверенность.ДатаДействия КАК СрокДействия,
		|	Доверенность.ПоДокументу КАК РеквизитыДокументаНаПолучение,
		|	Доверенность.Состав.(
		|		НомерСтроки КАК Номер,
		|		Номенклатура КАК Ценнности,
		|		Номенклатура.Наименование КАК ЦеннностиПредставление,
		|		ЕдиницаИзмерения КАК ЕдиницаИзмерения,
		|		ЕдиницаИзмерения.Представление КАК ЕдиницаИзмеренияПредставление,
		|		Количество
		|	)
		|ИЗ
		|	Документ.Доверенность КАК Доверенность
		|ГДЕ
		|	Доверенность.Ссылка = &ТекущийДокумент";
		Шапка = Запрос.Выполнить().Выбрать();
		Шапка.Следующий();
		ВыборкаСтрокТовары = Шапка.Состав.Выбрать();
		
		//ДолжностьДоверенного = Сотрудник.Должность;
		ФИОДоверенного = ?(СотрудникФИО="",Док.Сотрудник.Наименование,СотрудникФИО);
		ОбластьМакета = Макет.ПолучитьОбласть("Отрез");
		ОбластьМакета.Параметры.Заполнить(Шапка);
		ОбластьМакета.Параметры.ФИОДоверенного = ФИОДоверенного;
		ТабДокумент.Вывести(ОбластьМакета);
		НазваниеФормы = "Типовая межотраслевая форма № М-2";
		
		Руководители = ОбработкаПечатиСервер.ОтветственныеЛицаОрганизационнойЕдиницы(Шапка.Руководители, Шапка.ДатаДокумента);
		РуководительДолжность = Руководители.РуководительДолжность;
		Руководитель = Руководители.ФИОРуководителя;
		Бухгалтер    = Руководители.ФИОГлавногоБухгалтера;
		
		//ПаспортФизЛица  = ОбработкаПечатиСервер.ПолучитьПредставлениеДокументаФизЛица(ОбработкаПечатиСервер.ДанныеФизЛица(Ссылка.фирма,Шапка.Сотрудник, Шапка.ДатаДокумента));
		СведенияОбОрганизации = ОбработкаПечатиСервер.СведенияОЮрФизЛице(Шапка.Фирма, Шапка.ДатаДокумента);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
		ОбластьМакета.Параметры.Заполнить(Шапка);
		ОбластьМакета.Параметры.НомерДокумента                = Шапка.НомерДокумента;
		ОбластьМакета.Параметры.НазваниеФормы                 = НазваниеФормы;
		ОбластьМакета.Параметры.ОрганизацияПредставление      = ОбработкаПечатиСервер.ОписаниеОрганизации(СведенияОбОрганизации, "ПолноеНаименование,ИНН,ЮридическийАдрес,Телефоны,");
		ОбластьМакета.Параметры.РеквизитыСчета                = ОбработкаПечатиСервер.ОписаниеОрганизации(ОбработкаПечатиСервер.СведенияОЮрФизЛице(Шапка.БанковскийСчет, Шапка.ДатаДокумента), "НомерСчета,Банк,БИК,");
		ОбластьМакета.Параметры.РеквизитыПотребителя          = ОбработкаПечатиСервер.ОписаниеОрганизации(СведенияОбОрганизации, "ПолноеНаименование,ИНН,ЮридическийАдрес,Телефоны,");
		ОбластьМакета.Параметры.ОрганизацияКодПоОКПО          = СведенияОбОрганизации.КодПоОКПО;
		//ОбластьМакета.Параметры.ДолжностьДоверенного          = ДолжностьДоверенного;
		ОбластьМакета.Параметры.ФамилияИмяОчествоДоверенного  = ФИОДоверенного;
		//ОбластьМакета.Параметры.ПаспортСерия                  = ПаспортФизЛица.Серия;
		//ОбластьМакета.Параметры.ПаспортНомер                  = ПаспортФизЛица.Номер;
		//ОбластьМакета.Параметры.ПаспортВыдан                  = ПаспортФизЛица.Выдан;
		//ОбластьМакета.Параметры.ПаспортДатаВыдачи             = ПаспортФизЛица.ДатаВыдачи;
		ТабДокумент.Вывести(ОбластьМакета);
		
		ОбластьМакета = Макет.ПолучитьОбласть("ЗаголовокТаблицы");
		ТабДокумент.Вывести(ОбластьМакета);
		
		Пока ВыборкаСтрокТовары.Следующий() Цикл
			ОбластьМакета = Макет.ПолучитьОбласть("Строка");
			ОбластьМакета.Параметры.Заполнить(ВыборкаСтрокТовары);
			ОбластьМакета.Параметры.КоличествоПрописью = Строка(ВыборкаСтрокТовары.Количество) + " (" + 
			ОбработкаПечатиСервер.КоличествоПрописью(ВыборкаСтрокТовары.Количество) + ")";
			ТабДокумент.Вывести(ОбластьМакета);
		КонецЦикла;
		
		ОбластьМакета = Макет.ПолучитьОбласть("Подвал");
		ОбластьМакета.Параметры.Заполнить(Шапка);
		ОбластьМакета.Параметры.ФИОРуководителя  = Руководители.ФИОРуководителя;
		//ОбластьМакета.Параметры.Руководитель = Руководитель;
		ОбластьМакета.Параметры.РуководительДолжность = РуководительДолжность;
		ОбластьМакета.Параметры.ФИОГлавногоБухгалтера =Руководители.ФИОГлавногоБухгалтера;
		ТабДокумент.Вывести(ОбластьМакета);
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабДокумент, 
		НомерСтрокиНачало, ОбъектыПечати,Док.Ссылка);
		НомерСтрокиНачало = ТабДокумент.ВысотаТаблицы+1;
	конеццикла;
	
	Возврат ТабДокумент;
КонецФункции // ПечатьДоверенности()

Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм,
	ОбъектыПечати, ПараметрыВывода) Экспорт
	ПараметрыВывода.ДоступнаПечатьПоКомплектно = Истина;
	Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "М2") Тогда
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
		"М2", "М-2",ПечатьМ2(массивОбъектов,ОбъектыПечати));
	Конецесли;
КонецПроцедуры

