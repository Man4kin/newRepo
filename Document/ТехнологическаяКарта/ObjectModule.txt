
Процедура ОбработкаУдаленияПроведения(Отказ)
	Если ОбменДанными.Загрузка = Истина Тогда
		Возврат;
	КонецЕсли;	
	Отказ = Истина;
КонецПроцедуры

Процедура ОбработкаПроведения(Отказ, РежимПроведения)
	Если ВидПроизводства = Перечисления.ВидыПроизводства.Приготовление Тогда
		ИтогоКалорийность = 0;
		ИтогоБелки = 0;
		ИтогоЖиры = 0;
		ИтогоУглеводы = 0;
		Для Каждого Строка Из Состав Цикл
			ИтогоКалорийность = ИтогоКалорийность + Строка.Калорийность*10 * Строка.КоличествоНетто;
			ИтогоБелки = ИтогоБелки + Строка.Белки*10 * Строка.КоличествоНетто;
			ИтогоЖиры = ИтогоЖиры + Строка.Жиры*10 * Строка.КоличествоНетто;
			ИтогоУглеводы = ИтогоУглеводы + Строка.Углеводы*10 * Строка.КоличествоНетто;
		КонецЦикла;	
		ИтогоКалорийность = ИтогоКалорийность*МассаПорции/10;
		ИтогоБелки = ИтогоБелки*МассаПорции/10;
		ИтогоЖиры = ИтогоЖиры*МассаПорции/10;
		ИтогоУглеводы = ИтогоУглеводы*МассаПорции/10;
		
		Запись = РегистрыСведений.ПищеваяЦенность.СоздатьМенеджерЗаписи();
		Запись.Номенклатура = Продукция;
		Запись.ТехнологическаяКарта = Ссылка;
		Запись.Белки = ИтогоБелки;
		Запись.Жиры = ИтогоЖиры;
		Запись.Углеводы = ИтогоУглеводы;
		Запись.Калорийность = ИтогоКалорийность;
		Запись.Записать();
	КонецЕсли;	
КонецПроцедуры

Процедура ИнициализироватьДокумент()Экспорт
	Автор = ПараметрыСеанса.ТекущийПользователь;
КонецПроцедуры

Процедура ОбработкаЗаполнения(ДанныеЗаполнения, СтандартнаяОбработка)
	ИнициализироватьДокумент();
КонецПроцедуры

Процедура ПриКопировании(ОбъектКопирования)
	Автор = ПараметрыСеанса.ТекущийПользователь;
КонецПроцедуры

