ФУнкция ПечатьТехКарта(МассивОбъектов,ОбъектыПечати) экспорт
	ТабДок = Новый ТабличныйДокумент;	
	//Макет = ПолучитьМакет("Макет");
	Макет = УправлениеПечатью.ПолучитьМакет("Документ.ТехнологическаяКарта.Макет");
	ТабДок.ОриентацияСтраницы = ОриентацияСтраницы.Ландшафт;
	имяКолонкиСтр = "Код";
	НомерСтрокиНачало = 1;
	Для каждого док из массивОбъектов цикл
		Приготовление = ?(Док.ВидПроизводства = Перечисления.ВидыПроизводства.Приготовление, Истина, Ложь);
		
		// >>> вывод заголовка
		Область = Макет.ПолучитьОбласть("Заголовок|СтолбецСостава");	
		Область.Параметры.Номер = Док.Номер;
		Область.Параметры.Дата = Формат(Док.Дата,"ДФ=dd.MM.yyyy");
		Область.Параметры.Продукция = Док.Продукция;
		Область.Параметры.КоличествоПорций = Док.КоличествоПорций;
		Если Приготовление Тогда
			ИтогоКалорийность = 0;
			ИтогоБелки = 0;
			ИтогоЖиры = 0;
			ИтогоУглеводы = 0;
			Для Каждого Строка Из Док.Состав Цикл
				ИтогоКалорийность = ИтогоКалорийность + Строка.Калорийность * 10 * Строка.КоличествоНетто;
				ИтогоБелки = ИтогоБелки + Строка.Белки * 10 * Строка.КоличествоНетто;
				ИтогоЖиры = ИтогоЖиры + Строка.Жиры * 10 * Строка.КоличествоНетто;
				ИтогоУглеводы = ИтогоУглеводы + Строка.Углеводы * 10 * Строка.КоличествоНетто;
			КонецЦикла;	
			ИтогоКалорийность = ИтогоКалорийность*Док.МассаПорции/10;
			ИтогоБелки = ИтогоБелки*Док.МассаПорции/10;
			ИтогоЖиры = ИтогоЖиры*Док.МассаПорции/10;
			ИтогоУглеводы = ИтогоУглеводы*Док.МассаПорции/10;
			Область.Параметры.Калорийность = Формат(ИтогоКалорийность,"ЧДЦ=2");
		КонецЕсли;	
		
		ШтрихкодированиеПечатныхФорм.ВывестиШтрихкодВТабличныйДокумент(ТабДок, Макет, Область, Док);
		
		ТабДок.Вывести(область);
		Область = Макет.ПолучитьОбласть("Заголовок|"+?(Приготовление,"БруттоНетто","Выход"));
		ТабДок.Присоединить(Область);
		
		// >>> вывод шапки
		Область = Макет.ПолучитьОбласть("Шапка|СТолбецСостава");
		Область.Параметры.КолонкаАртикулКодИмя = ИмяКолонкиСтр;
		ТабДок.Вывести(Область);
		Область = Макет.ПолучитьОбласть("Шапка|"+?(Приготовление,"БруттоНетто","Выход"));
		ТабДок.Присоединить(Область);
		Область = Макет.ПолучитьОбласть("Шапка|СтолбецТехнологии");
		ТабДок.Присоединить(Область);
		
		
		// >>> вывод строк
		Для Каждого Строка Из Док.Состав Цикл		
			ОбластьСостава = Макет.ПолучитьОбласть("Строка|СтолбецСостава");
			КолонкаАРтикулКодЗначение = Строка.Номенклатура[ИмяКолонкиСтр];
			ОбластьСостава.Параметры.КолонкаАртикулКодЗначение =КолонкаАртикулКодЗначение;
			ОбластьСостава.Параметры.Номенклатура = Строка.Номенклатура.Наименование;		
			ТабДок.ВЫвести(ОбластьСостава);
			Если   Приготовление тогда
				ОбластьБруттоНетто = Макет.ПолучитьОбласть("Строка|БруттоНетто");
				ОбластьБруттоНетто.Параметры.ЕдиницаИзмерения = Строка.ЕдиницаИзмерения;
				ОбластьБруттоНетто.Параметры.Количество = Строка.Количество;
				ОбластьБруттоНетто.Параметры.КоличествоНетто = Строка.КоличествоНетто;
				ТабДок.Присоединить(ОбластьБруттоНетто);
			Иначе
				ОбластьВыход = Макет.ПолучитьОбласть("Строка|Выход");
				ОбластьВыход.Параметры.ВыходПроценты = Строка.Количество;
				ТабДок.Присоединить(ОбластьВыход);
			КОнецесли;		
		КонецЦикла;	
		ОбластьТехнологии = ТабДок.Область(НомерСтрокиНачало+8,?(Не Приготовление,6,7),НомерСтрокиНачало+7+Док.Состав.Количество(),?(Не Приготовление,6,7));
		ОбластьТехнологии.Объединить();
		ОбластьТехнологии.РазмещениеТекста = ТипРазмещенияТекстаТабличногоДокумента.Переносить; 
		ОбластьТехнологии.Текст = Док.Описание;
		ЛинияРамки = Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная);
		ОбластьТехнологии.Обвести(ЛинияРамки,ЛинияРамки,ЛинияРамки,линияРамки);
		ОбластьТехнологии.ГоризонтальноеПоложение = ГоризонтальноеПОложение.Центр;
		ОбластьТехнологии.ВертикальноеПоложение = ВертикальноеПОложение.Центр;
		
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабДок, 
		НомерСтрокиНачало, ОбъектыПечати,Док.Ссылка);
		НомерСтрокиНачало = ТабДок.ВысотаТаблицы+1;
	КонецЦикла;
	Возврат ТабДок;
КонецФункции // Печать


Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм,
	ОбъектыПечати, ПараметрыВывода) Экспорт
	ПараметрыВывода.ДоступнаПечатьПоКомплектно = Истина;
	Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "ТехнологическаяКарта") Тогда
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
		"ТехнологическаяКарта", "ТехнологическаяКарта", ПечатьТехКарта(массивОбъектов,ОбъектыПечати));
	КонецЕсли;
КонецПроцедуры
