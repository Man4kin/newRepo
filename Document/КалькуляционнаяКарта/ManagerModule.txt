Функция ПечатьКалькуляционнаяКарта(МассивОбъектов,ОбъектыПечати) экспорт
	ТабДокумент = Новый ТабличныйДокумент;	
	//Макет = ПолучитьМакет("ОП1");
	Макет = УправлениеПечатью.ПолучитьМакет("Документ.КалькуляционнаяКарта.ОП1");

	//ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Ландшафт;
	Для каждого док из массивОбъектов цикл
		Блюдо = док.Продукция;
		ЕдиницаИзмеренияБлюда = Док.Продукция.БазоваяЕдиницаИзмерения;
		КоличествоПорцийБлюда =   Док.КоличествоПорций;
		ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьШапка.Параметры.Блюдо = Блюдо;
		ОбластьШапка.Параметры.ФирмаПредставление = Док.Фирма;
		ОбластьШапка.Параметры.Фирма = Док.Фирма;
		//ОбластьШапка.Параметры.СтруктурнаяЕдиницаПредставление = Док.СтруктурнаяЕдиница;
		ОбластьШапка.Параметры.ФирмаКодПоОкпо = Док.Фирма.КодПоОКПО;
		ОбластьШапка.Параметры.ГотоваяПродукцияНомерПоСправочнику = Док.НомерПоСправочнику;
		ОбластьШапка.Параметры.НомерДатаДок =  "№ "+?(НЕ ЗначениеЗаполнено(Док.Номер),"______________",Док.Номер)+" от "+?(НЕ ЗначениеЗаполнено(Док.Дата),"______________",Док.Дата);
		ОбластьШапка.Параметры.НомерКарты = Док.Номер;
		//ОбластьШапка.Параметры.структурнаяЕдиница = Док.СтруктурнаяЕдиница;
		ОбластьШапка.Параметры.ГотоваяПродукция = Блюдо;
		ТабДокумент.вывести(ОбластьШапка);
		Для каждого Строка	Из Док.Состав Цикл
			Составляющее = Строка.Номенклатура;
			КодСоставляющего = Строка.Номенклатура.Код;
			КоличествоСоставляющего = Строка.Количество*Строка.Коэффициент;
			КоличествоСоставляющего = ""+Формат(КоличествоСоставляющего,"ЧДЦ=3")+" "+Строка.ЕдиницаИзмерения;
			ЦенаСоставляющего = Формат(Строка.Цена,"ЧДЦ=2");
			СтоимостьСоставляющего = Формат(Строка.Сумма,"ЧДЦ=2");
			Областьстрока = Макет.ПолучитьОбласть("Строка");
			Областьстрока.Параметры.НомерСтрокиСоставляющего = Строка.НомерСтроки;
			Областьстрока.Параметры.Составляющее = Составляющее;
			Областьстрока.Параметры.Кодсоставляющего = Кодсоставляющего;
			Областьстрока.Параметры.КоличествоСоставляющего = количествосоставляющего;
			Областьстрока.Параметры.ЦенаСоставляющего = ЦенаСоставляющего;
			Областьстрока.Параметры.Стоимостьсоставляющего = СтоимостьСоставляющего;
			ОбластьСтрока.Параметры.ГотоваяПродукция = Док;
			ОбластьСтрока.Параметры.Блюдо = Блюдо;
			ТабДокумент.вывести(Областьстрока);
		конеццикла;
		ОбластьПодвал = Макет.ПолучитьОбласть("Подвал");
		СтоимостьСоставляющегоВсего = Док.Состав.Итог("Сумма");
		ОбластьПодвал.Параметры.СтоимостьСоставляющегоВсего = СтоимостьСоставляющегоВсего;
		ОбластьПодвал.Параметры.ЕдиницаИзмеренияБлюда = ЕдиницаИзмеренияБлюда ;
		ОбластьПодвал.Параметры.КолвоПорцийБлюда =КоличествоПорцийБлюда ;
		ЦенаПродажи = 0;
		//ЦенаПродажи = УправлениеЦенамиСервер.ПолучитьЦенуНаДату(Док.Дата,Док.Продукция, ОбработкаТабличныхЧастейСервер.ПолучитьЕдиницуИзмеренияНоменклатурыПоУмолчанию(Док.Продукция),Док.СтруктурнаяЕдиница);
		ОбластьПодвал.Параметры.ЦенаПродажи	= Формат(ЦенаПродажи, "ЧДЦ=2");
		СтоимостьЕдиницыБлюда =?(КоличествоПорцийБлюда=0,0,СтоимостьСоставляющегоВсего/КоличествоПорцийБлюда);
		СтоимостьСоставляющегоВсего = Формат(СтоимостьСоставляющегоВсего,"ЧДЦ=2");
		Наценка = ?(СтоимостьЕдиницыБлюда = 0 или ЦенаПродажи = 0,0,(ЦенаПродажи-СтоимостьЕдиницыБлюда)*100/СтоимостьЕдиницыблюда);
		КолвоПорцийБлюда = Формат(колвоПорцийБлюда,"ЧДЦ=3");
		Наценка = ?(Наценка = 0,0,Формат(Наценка,"ЧДЦ=2")+"%");
		ОбластьПодвал.Параметры.Наценка = Наценка;
		ТабДокумент.вывести(областьПодвал);
		ТабДокумент.вывестиГоризонтальныйРазделительСтраниц();
	КонецЦикла;
	Возврат ТабДокумент;
КонецФункции // Печать


Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм,
	ОбъектыПечати, ПараметрыВывода) Экспорт
	ПараметрыВывода.ДоступнаПечатьПоКомплектно = Истина;
	Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "КалькуляционнаяКарта") Тогда
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
		"КалькуляционнаяКарта", "КалькуляционнаяКарта", ПечатьКалькуляционнаяКарта(массивОбъектов,ОбъектыПечати));
	КонецЕсли;
КонецПроцедуры
