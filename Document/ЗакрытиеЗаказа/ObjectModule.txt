
Процедура ОбработкаПроведения(Отказ, РежимПроведения)
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ЗаказыИсходящиеОстатки.Номенклатура,
		|	&Дата КАК Период,
		|	ЗаказыИсходящиеОстатки.КоличествоОстаток КАК Количество,
		|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) КАК ВидДвижения,
		|	ЗаказыИсходящиеОстатки.ПоДокументу
		|ИЗ
		|	РегистрНакопления.ЗаказыИсходящие.Остатки КАК ЗаказыИсходящиеОстатки
		|ГДЕ
		|	ЗаказыИсходящиеОстатки.ПоДокументу = &ПоДокументу
		|	И ЗаказыИсходящиеОстатки.КоличествоОстаток > 0";

	Запрос.УстановитьПараметр("ПоДокументу", ДокОснование);
	Запрос.УстановитьПараметр("Дата", Дата);

	Результат = Запрос.Выполнить();

	тзЗаказы = Результат.Выгрузить();

	Движения.ЗаказыИсходящие.Загрузить(тзЗаказы);
	Движения.ЗаказыИсходящие.Записывать=Истина;
КонецПроцедуры

Процедура ОбработкаЗаполнения(ДанныеЗаполнения, СтандартнаяОбработка)
	ИнициализироватьДокумент();
	Если ТипЗнч(ДанныеЗаполнения) = Тип("ДокументСсылка.ПланируемаяПоставка") Тогда
		ДокОснование = ДанныеЗаполнения.Ссылка;
	КонецЕсли;
КонецПроцедуры

Процедура ИнициализироватьДокумент()Экспорт
	Автор = ПараметрыСеанса.ТекущийПользователь;
КонецПроцедуры
