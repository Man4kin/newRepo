ФУнкция ПечатьСчет(МассивОбъектов,ОбъектыПечати) экспорт
	ТабДок = Новый ТабличныйДокумент;	
	НомерСтрокиНачало = 0;
	для каждого док из массивОбъектов цикл
		Запрос = Новый Запрос;
		Запрос.Текст = "ВЫБРАТЬ
		|	Счет.БанковскийСчет.НомерСчета КАК СчетПолучателя,
		|	Счет.БанковскийСчет.НаименованиеБанка КАК БанкПолучателя,
		|	Счет.БанковскийСчет.КоррСчетБанка КАК СчетБанкаПолучателя,
		|	Счет.Фирма.ИНН КАК ИНН,
		|	Счет.БанковскийСчет.БИКБанка КАК БИКБанкаПолучателя,
		|	Счет.Фирма,
		|	Счет.Контрагент,
		|	Счет.БанковскийСчет.ГородБанка КАК БанкГород
		|ИЗ
		|	Документ.Счет КАК Счет
		|ГДЕ
		|	Счет.Ссылка = &Ссылка";
		Запрос.УстановитьПараметр("Ссылка",Док.ссылка);
		Запрос.УстановитьПараметр("Контрагент",Док.Контрагент);
		Запрос.УстановитьПараметр("Фирма",Док.Фирма);
		Запрос.УстановитьПараметр("НаДату",Док.Дата);
		Результат = Запрос.Выполнить();
		//Макет = ПолучитьМакет("Макет");
		Макет = УправлениеПечатью.ПолучитьМакет("Документ.Счет.Макет");
		сведенияОПоставщике = ОбработкаПечатиСервер.СведенияОЮрФизЛице(Док.Ссылка.Фирма,Док.Ссылка.Дата,Док.СтруктурнаяЕдиница);
		СведенияОПокупателе = ОбработкаПечатиСервер.СведенияОЮрФизЛице(Док.Ссылка.Контрагент,Док.Ссылка.Дата);
		ПредставлениеПоставщика = ОбработкаПечатиСервер.ОписаниеОрганизации(СведенияОПоставщике);
		ПредставлениеПокупателя  = ОбработкаПечатиСервер.ОписаниеОрганизации(СведенияОПокупателе);
		Область = Макет.ПолучитьОбласть("Заголовок");
		Область.Параметры.печЗаголовок = "Счет";		
		Область.Параметры.Номер = Док.Номер;		
		Область.Параметры.Дата = Формат(Док.Дата,"ДФ=dd.MM.yyyy");
		ШтрихкодированиеПечатныхФорм.ВывестиШтрихкодВТабличныйДокумент(ТабДок, Макет, Область, Док);
		ТабДок.Вывести(Область);
		Выборка = Результат.Выбрать();
		Пока Выборка.Следующий() цикл
			ИНН = Выборка.ИНН;
			КПП = ОбработкаПечатиСервер.ОписаниеОрганизации(СведенияОПоставщике,"КПП");
			БанкПолучателя = СокрЛП(Выборка.БанкПолучателя) + "," + Выборка.БанкГород;
			БИКБанкаПолучателя  = Выборка.БИКБанкаПолучателя;
			СчетПолучателя = Выборка.СчетПолучателя;
			СчетБанкаПолучателя = Выборка.СЧетБанкаПолучателя;
			//*Зернятко А.В.@06.11.2013 - //AKB-374. Ответственные лица СЕ
			//Руководители = ОбработкаПечатиСервер.ОтветственныеЛицаОрганизационнойЕдиницы(Док.Ссылка.фирма, Док.Ссылка.Дата);
			Руководители = ОбработкаПечатиСервер.ОтветственныеЛицаОрганизационнойЕдиницы(Док.фирма, Док.Дата, Док.СтруктурнаяЕдиница);
			///Зернятко А.В.@ - конец блока
			РуководительДолжность = Руководители.РуководительДолжность;	
		КонецЦикла;
		ОбработкаПечатиСервер.ВывестиСтрокуЗаголовкаДляНакладной(Макет,ТабДок,"Поставщик",ПредставлениеПоставщика);
		Значение = неопределено;
		СведенияОПоставщике.свойство("ПочтовыйАдрес",Значение);
		если Значение<>Неопределено тогда
			ОбработкаПечатиСервер.ВывестиСтрокуЗаголовкаДляНакладной(Макет,ТабДок,"Почтовый адрес:",Значение);
		Конецесли;
		
		Область = Макет.ПолучитьОбласть("ЗаголовокТаблица");
		Область.Параметры.БанкПолучателя = БанкПолучателя;
		Область.Параметры.ИНН = Инн;
		Область.Параметры.КПП = КПП;
		Область.Параметры.Поставщик = Док.Фирма
		;
		Область.Параметры.БикБанкаПолучателя = БИКБанкаПолучателя;
		Область.Параметры.СчетПолучателя = СчетПолучателя;
		Область.Параметры.СчетБанкаПолучателя = СчетБанкаПолучателя;
		
		ТабДок.Вывести(Область);
		ОбработкаПечатиСервер.ВывестиСтрокуЗаголовкаДляНакладной(Макет,ТабДок,"Покупатель",ПРедставлениеПОкупателя);	
		Значение = неопределено;
		СведенияОПокупателе.свойство("ПочтовыйАдрес",Значение);
		если Значение<>Неопределено тогда
			ОбработкаПечатиСервер.ВывестиСтрокуЗаголовкаДляНакладной(Макет,ТабДок,"Почтовый адрес:",Значение);
		Конецесли;
		
		// >>> вывод шапки
		Область = Макет.ПолучитьОбласть("Шапка");
		Область.Параметры.КолонкаАртикулКодИмя = "Код";
		ТабДок.Вывести(Область);
		
		// >>> вывод строк
		НомерСтроки = 1;
		Для Каждого Строка Из Док.Состав Цикл		
			Область = Макет.ПолучитьОбласть("Строка");
			Область.Параметры.КолонкаАртикулКодЗначение = Строка.Номенклатура.Код;
			Область.Параметры.Номерстроки = НомерСтроки;
			Область.Параметры.ПечНоменклатура = Строка.Номенклатура.Наименование;		
			Область.Параметры.Номенклатура = Строка.Номенклатура;
			Область.Параметры.ЕдиницаИзмерения = Строка.ЕдиницаИзмерения;	
			Область.Параметры.Количество = Строка.Количество;
			Область.Параметры.Цена = Строка.Цена;
			Область.Параметры.Всего = Строка.Сумма;
			ТабДок.Вывести(Область);
			НомерСтроки = НомерСтроки+1;
		КонецЦикла;	
		
		Область = Макет.ПолучитьОбласть("Итоги");
		Область.Параметры.ИтогоВсего = Формат(Док.Состав.Итог("Сумма"),"ЧЦ=15; ЧДЦ=2"); 		
		Область.Параметры.ИтогоНДС = Формат(Док.Состав.Итог("СуммаНДС"),"ЧЦ=15; ЧДЦ=2");
		ТабДок.Вывести(Область);
		Область = Макет.ПолучитьОбласть("Подвал");
		Область.Параметры.СуммаПрописью =ОбработкаПечатиСервер.СформироватьСуммуПрописью(Док.Состав.Итог("СУмма"), Док.ССылка.Валюта) ;
		Область.Параметры.РуководительДолжность = РуководительДолжность;
		Область.Параметры.Руководитель = Руководители.ФИоРуководителя;
		Область.Параметры.ГлБух = Руководители.ФиоГлавногоБухгалтера;
		ТабДок.Вывести(Область);
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабДок, 
		НомерСтрокиНачало, ОбъектыПечати,Док.Ссылка);
		НомерСтрокиНачало = ТабДок.ВысотаТаблицы+1;
	конеццикла;
	Возврат ТабДок;
КонецФункции // Печать


Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм,
	ОбъектыПечати, ПараметрыВывода) Экспорт
	ПараметрыВывода.ДоступнаПечатьПоКомплектно = Истина;
	Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "Счет") Тогда
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
		"Счет", "Счет", ПечатьСЧет(массивОбъектов,ОбъектыПечати));
	КонецЕсли;
КонецПроцедуры

