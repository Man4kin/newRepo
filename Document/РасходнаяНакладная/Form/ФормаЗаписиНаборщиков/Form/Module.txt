
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если НЕ ЗначениеЗаполнено(Параметры.ДокСсылка) Тогда 
		Отказ=Истина; 
		Возврат; 
	КонецЕсли;
	ДокСсылка = Параметры.ДокСсылка;
	ЗначениеВРеквизитФормы(ДокСсылка.Грузчики.Выгрузить(),"Грузчики");
	Контроллер = ДокСсылка.Контролер;
	ЭтаФорма.Заголовок = ДокСсылка;
КонецПроцедуры

&НаСервере
Функция НайтиГруппуНаборщики()
	Возврат Справочники.ФизическиеЛица.НайтиПоКоду("Наборщики");
КонецФункции

&НаКлиенте
Процедура ГрузчикиГрузчикНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	ТекСтрока = Элементы.Грузчики.ТекущиеДанные;
	СтандартнаяОбработка = Ложь;
	Форма = ПолучитьФорму("Справочник.ФизическиеЛица.ФормаВыбора");
	Форма.Элементы.Список.РодительВерхнегоУровня = НайтиГруппуНаборщики();//ПредопределенноеЗначение("Справочник.ФизическиеЛица.Наборщики");
	ТекСтрока.Грузчик = Форма.ОткрытьМодально();
КонецПроцедуры

&НаСервере
Функция ЗаписатьВДокументНаСервере()
	ДокСсылка = Параметры.ДокСсылка;
	ДокОбъект = ДокСсылка.Получитьобъект();
	тзГрузчики = РеквизитФормыВЗначение("Грузчики");
	ДокОбъект.Грузчики.Загрузить(тзГрузчики);
	ДокОбъект.контролер = Контроллер;
	Попытка 
		//{БредовЮГ доработка по инциденту от Чураковой
		Izh_ОбменДанными.УстановитьОбменДаннымиЗагрузка(ДокОбъект);// вставил доп свойсов, т.к. документ заблокирован от изменений.
		//БредовЮГ доработка по инциденту от Чураковой}
		ДокОбъект.Записать(РежимЗаписиДокумента.Запись);
		Возврат Истина;
	Исключение
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю("Ошибка: "+ОписаниеОшибки(),ДокОбъект);
		Возврат Ложь;
	КонецПопытки;
КонецФункции
	
&НаКлиенте
Процедура ЗаписатьВДокумент(Команда)
	Если ЗаписатьВДокументНаСервере() Тогда
		ЭтаФорма.Закрыть();
	КонецЕсли;
КонецПроцедуры
