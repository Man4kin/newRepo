Функция ПечатьНакладная(МассивОбъектов,ОбъектыПечати)Экспорт
	СтрукРеквизитыШапки = новый Структура;
	СТрукРеквизитыШапки.Вставить("СтруктурнаяЕдиница","Структурная единица");
	СтрукРеквизитыШапки.Вставить("Контрагент","Покупатель");
	СтрукРеквизитыШапки.Вставить("ДокОснование","Документ-основание");
	//СтрукРеквизитыШапки.Вставить("Основание","Основание");
	СтрукРеквизитыШапки.Вставить("АдресДоставки","Адрес доставки");
	ВыводитьБезНДС = Не ОбщегоНазначенияСервер.ПолучитьЗначениеКонстанты("ВключатьНДСВЦеныКонтрагентов");
	СтрукРеквизитыТабЧасти = новый Структура;
	СтрукРеквизитыТабЧасти.Вставить("НомерСтроки");
	СтрукРеквизитыТабЧасти.Вставить("Номенклатура");
	СтрукРеквизитыТабЧасти.Вставить("ЕдиницаИзмерения");
	СтрукРеквизитыТабЧасти.Вставить("Количество");
	Если ВыводитьБезНДС Тогда
		СтрукРеквизитыТабЧасти.Вставить("ЦенаБезНДС");
	КонецЕсли;
	СтрукРеквизитыТабЧасти.Вставить("Цена");
	Если ВыводитьБезНДС Тогда
		СтрукРеквизитыТабЧасти.Вставить("СуммаБезНДС",Истина);
	КонецЕсли;
	СтрукРеквизитыТабЧасти.Вставить("СуммаНДС",Истина);
	СтрукРеквизитыТабЧасти.Вставить("Сумма",Истина);
	ТабДок = ОбработкаПечатиСервер.ПечатьНакладнойОбщая(МассивОбъектов,ОбъектыПечати,"Состав",СтрукРеквизитыШапки,СтрукРеквизитыТабЧасти);
	Возврат ТабДок;
КонецФункции

Функция ПечатьТОРГ12(МассивОбъектов,ОбъектыПечати) Экспорт
	ТабДокумент = Новый ТабличныйДокумент;
	СтрукРеквизитыШапки = новый Структура();
	СТрукРеквизитыШапки.Вставить("СтруктурнаяЕдиница","СтруктурнаяЕдиница");
	//+Зернятко@27.03.2014 - Изменён порядок передачи даны в процедуру печати. Ключ - ИмяПоля, Значение - путь к реквизиту документа	
	//СтрукРеквизитыШапки.вставить("Контрагент","Покупатель");
	//СтрукРеквизитыШапки.Вставить("Грузополучатель","Грузополучатель");
	//СтрукРеквизитыШапки.Вставить("Грузоотправитель","Грузоотправитель");
	//СтрукРеквизитыШапки.Вставить("Фирма","Поставщик");
	СтрукРеквизитыШапки.вставить("Покупатель","Контрагент");
	СтрукРеквизитыШапки.Вставить("Грузополучатель","Грузополучатель");
	СтрукРеквизитыШапки.Вставить("Грузоотправитель","Грузоотправитель");
	СтрукРеквизитыШапки.Вставить("Поставщик","Фирма");
	//{{ШиловМВ 29.12.14 №000138544
	СтрукРеквизитыШапки.Вставить("ДокОснование","ДокОснование");
	//}}ШиловМВ 29.12.14 №000138544
 	///Зернятко@27.03.2014 - конец блока
	СтрукРеквизитыТабЧасти = новый Структура;
	СтрукРеквизитыТабЧасти.Вставить("НомерСтроки");
	СтрукРеквизитыТабЧасти.Вставить("Номенклатура");
	СтрукРеквизитыТабЧасти.Вставить("ЕдиницаИзмерения");
	СтрукРеквизитыТабЧасти.Вставить("Количество");
	СтрукРеквизитыТабЧасти.Вставить("Цена");
	СтрукРеквизитыТабЧАсти.Вставить("СтавкаНДС");
	СтрукРеквизитыТабЧасти.Вставить("СуммаНДС",Истина);
	СтрукРеквизитыТабЧасти.Вставить("Сумма",Истина);
	ТабДокумент = ОбработкаПечатиСервер.ПечатьТОРГ12Общая(МассивОбъектов,ОбъектыПечати,"Состав",СтрукРеквизитыШапки,СтрукРеквизитыТабЧасти);
	Возврат ТабДокумент;
КонецФункции

Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм,
	ОбъектыПечати, ПараметрыВывода) Экспорт
	ПараметрыВывода.ДоступнаПечатьПоКомплектно = Истина;

	Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "Накладная") Тогда
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
		"Накладная", "Накладная", ПечатьНакладная(массивОбъектов,ОбъектыПечати));
	ИначеЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "ТОРГ12") Тогда
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
		"ТОРГ12", "ТОРГ-12", ПечатьТОРГ12(массивОбъектов,ОбъектыПечати));
	ИначеЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "ТОРГ13") Тогда
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
		"ТОРГ13", "ТОРГ-13", ПечатьТОРГ13(массивОбъектов,ОбъектыПечати));
	ИначеЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "ТОРГ15") Тогда
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
		"ТОРГ15", "ТОРГ-15", ПечатьТОРГ15(массивОбъектов,ОбъектыПечати));
	ИначеЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "ПретензияТОРГ15") Тогда
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
		"ПретензияТОРГ15", "Претензия ТОРГ-15", ПечатьПретензияТОРГ15(массивОбъектов,ОбъектыПечати));		
	ИначеЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "СчетФактура1137") Тогда
		//{ ВетровИА 05.03.2015 } 
		МассивОбъектовСчетФактуры = Новый Массив;
		Для Каждого Объект Из МассивОбъектов Цикл
			МассивОбъектовСчетФактуры.Добавить(Документы.СчетФактура.НайтиПоРеквизиту("ДокОснование", Объект));		
		КонецЦикла;
	    Документы.СчетФактура.Печать(МассивОбъектовСчетФактуры, ПараметрыПечати, КоллекцияПечатныхФорм,ОбъектыПечати, ПараметрыВывода);
		//{ ВетровИА 05.03.2015 } 
	КонецЕсли
	
КонецПроцедуры

Функция ПечатьТОРГ13(МассивОбъектов,ОбъектыПечати) экспорт
	СтрукРеквизитыШапки = Новый Структура();
	СтрукРеквизитыШапки.вставить("Отправитель","СтруктурнаяЕдиница");
	СтрукРеквизитыШапки.Вставить("Получатель","Контрагент");
	СтрукРеквизитыШАпки.Вставить("Фирма","Фирма");
	СТрукРеквизитыТабЧасти = Новый Структура();
	СТрукРеквизитыТабЧасти.Вставить("НомерСтроки","НомерСтроки");
	СтрукРеквизитыТабЧАсти.Вставить("Номенклатура","Номенклатура");
	ТабДок = ОбработкаПечатиСервер.ПечатьТОРГ13Общая(МассивОбъектов,ОбъектыПечати,"Состав",СтрукРеквизитыШапки,СтрукРеквизитыТабЧАсти);
	Возврат ТабДок;
КонецФункции

Функция ПечатьТОРГ15(массивОбъектов, ОбъектыПечати)
	УстановитьПривилегированныйРежим(Истина);
	
	ТабДокумент = Новый ТабличныйДокумент;
	Макет = УправлениеПечатью.ПолучитьМакет("ОбщийМакет.ТОРГ15");
		
	Запрос1 = Новый Запрос;
	Запрос1.Текст = "ВЫБРАТЬ
	                |	РасходнаяНакладнаяСостав.Ссылка.Номер КАК Номер,
	                |	РасходнаяНакладнаяСостав.Ссылка.Дата КАК Дата,
	                |	РасходнаяНакладнаяСостав.Ссылка.Фирма КАК Фирма,
	                |	РасходнаяНакладнаяСостав.Ссылка.СтруктурнаяЕдиница КАК СтруктурнаяЕдиница,
	                |	РасходнаяНакладнаяСостав.Номенклатура,
	                |	РасходнаяНакладнаяСостав.Номенклатура.Наименование КАК ТоварНаименование,
	                |	РасходнаяНакладнаяСостав.Номенклатура.Код КАК Код,
	                |	РасходнаяНакладнаяСостав.ЕдиницаИзмерения,
	                |	РасходнаяНакладнаяСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.ПолноеНаименование КАК ЕдИзмНаименование,
	                |	РасходнаяНакладнаяСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Код КАК КодОКЕИ,
	                |	"""" КАК Артикул,
	                |	"""" КАК Сорт,
	                |	РасходнаяНакладнаяСостав.Количество КАК Количество,
	                |	РасходнаяНакладнаяСостав.Цена,
					//++БИТ БВО 2015-10-21
	                //|	РасходнаяНакладнаяСостав.СуммаБезНДС КАК Сумма,
					|	РасходнаяНакладнаяСостав.Сумма - РасходнаяНакладнаяСостав.СуммаНДС КАК Сумма,
					//--БИТ БВО 2015-10-21
	                |	РасходнаяНакладнаяСостав.Ссылка.Основание,
	                |	РасходнаяНакладнаяСостав.Ссылка.Контрагент
	                |ИЗ
	                |	Документ.РасходнаяНакладная.Состав КАК РасходнаяНакладнаяСостав
	                |ГДЕ
	                |	РасходнаяНакладнаяСостав.Ссылка В(&Ссылка)
	                |	И РасходнаяНакладнаяСостав.Ссылка.Возврат = ИСТИНА
	                |ИТОГИ
	                |	СУММА(Количество),
	                |	СУММА(Сумма)
	                |ПО
	                |	РасходнаяНакладнаяСостав.Ссылка";
		
	Запрос1.Параметры.Вставить("Ссылка", МассивОбъектов);
	
	ВыборкаТЧ1_Итоги = Запрос1.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	Пока ВыборкаТЧ1_Итоги.Следующий() Цикл
		
		ОписаниеОрганизации = ОбработкаПечатиСервер.СведенияОЮрФизЛице(ВыборкаТЧ1_Итоги.Фирма, ВыборкаТЧ1_Итоги.Дата, ВыборкаТЧ1_Итоги.СтруктурнаяЕдиница);
		ОписаниеОрганизацииКонтрагента = ОбработкаПечатиСервер.СведенияОЮрФизЛице(ВыборкаТЧ1_Итоги.Контрагент, ВыборкаТЧ1_Итоги.Дата, ВыборкаТЧ1_Итоги.СтруктурнаяЕдиница);   
		Руководители        = ОбработкаПечатиСервер.ОтветственныеЛицаОрганизационнойЕдиницы(ВыборкаТЧ1_Итоги.Фирма, ВыборкаТЧ1_Итоги.Дата, ВыборкаТЧ1_Итоги.СтруктурнаяЕдиница);

		ОбластьМакета       = Макет.ПолучитьОбласть("ТЧ1_Шапка");
	 			
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечНомер                    = ВыборкаТЧ1_Итоги.Номер;
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечДата                     = Формат(ВыборкаТЧ1_Итоги.Дата, "ДФ=dd.MM.yyyy");
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечФирма                    = ОписаниеОрганизации.ПолноеНаименование + ", ИНН " + ОписаниеОрганизации.ИНН + ", " + 
			СокрЛП(ОписаниеОрганизации.ЮридическийАдрес) + ", " + ОписаниеОрганизации.Телефоны + ", р/cч " + ОписаниеОрганизации.НомерСчета + ", БИК " + 
			ОписаниеОрганизации.БИК + ", к/сч " + ОписаниеОрганизации.КоррСчет;
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечСтруктурноеПодразделение = ВыборкаТЧ1_Итоги.СтруктурнаяЕдиница.Наименование;
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечПоставщик                = ОписаниеОрганизацииКонтрагента.ПолноеНаименование + ", ИНН " + ОписаниеОрганизацииКонтрагента.ИНН + ", " +  
			СокрЛП(ОписаниеОрганизацииКонтрагента.ЮридическийАдрес) + ", " + ОписаниеОрганизацииКонтрагента.Телефоны + ", р/cч " + ОписаниеОрганизацииКонтрагента.НомерСчета + ", БИК " + 
			ОписаниеОрганизацииКонтрагента.БИК + ", к/сч " + ОписаниеОрганизацииКонтрагента.КоррСчет;
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечОснование                = ВыборкаТЧ1_Итоги.Основание;
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечФирмаОКПО                = ОписаниеОрганизации.КодПоОКПО;
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечПоставщикОКПО            = "";
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечПоставщикОКДП            = "";
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечДолжность                = Руководители.РуководительДолжность;
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечРасшифровка              = Руководители.ФИОРуководителя;
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечЧисло                    = Формат(ВыборкаТЧ1_Итоги.Дата, "ДФ=dd");
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечМесяц                    = Формат(ВыборкаТЧ1_Итоги.Дата, "ДФ=MMММ");
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечГод                      = Формат(ВыборкаТЧ1_Итоги.Дата, "ДФ=yyyy");
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечПричина                  = "";
		ОбластьМакета.Параметры.ТЧ1_Шапка_ПечКод                      = "";
		
		ТабДокумент.Вывести(ОбластьМакета);
		
		
		// Выводим заголовок ТЧ1 таблицы
		ОбластьМакета = Макет.ПолучитьОбласть("ТЧ1_Заголовок");
		ТабДокумент.Вывести(ОбластьМакета);
		
		
		// Выводим строки ТЧ1 таблицы
		ОбластьМакета = Макет.ПолучитьОбласть("ТЧ1_СтрокаСредняя");
	
		ВыборкаТЧ1 = ВыборкаТЧ1_Итоги.Выбрать();
		Пока ВыборкаТЧ1.Следующий() Цикл
			
			ОбластьМакета.Параметры.ТЧ1_Печ1  = ВыборкаТЧ1.ТоварНаименование;
			ОбластьМакета.Параметры.ТЧ1_Печ2  = ВыборкаТЧ1.Код;
			ОбластьМакета.Параметры.ТЧ1_Печ3  = ВыборкаТЧ1.ЕдИзмНаименование;
			ОбластьМакета.Параметры.ТЧ1_Печ4  = ВыборкаТЧ1.КодОКЕИ;
			ОбластьМакета.Параметры.ТЧ1_Печ5  = ВыборкаТЧ1.Артикул;
			ОбластьМакета.Параметры.ТЧ1_Печ6  = ВыборкаТЧ1.Сорт;
			ОбластьМакета.Параметры.ТЧ1_Печ7  = Формат(ВыборкаТЧ1.Количество, "ЧЦ=15; ЧДЦ=3; ЧН=");
			Если ВыборкаТЧ1.Количество = 0 Тогда                                                                   //dps+ 15/07/03 131193
				Цена = ВыборкаТЧ1.Цена;
			Иначе 
				Цена = ВыборкаТЧ1.Сумма/ВыборкаТЧ1.Количество;
			КонецЕсли;
			ОбластьМакета.Параметры.ТЧ1_Печ8  = Формат(Цена, "ЧЦ=15; ЧДЦ=2; ЧН=");  //Формат(ВыборкаТЧ1.Цена      , "ЧЦ=15; ЧДЦ=2; ЧН=");  //dps- 15/07/03 131193
			ОбластьМакета.Параметры.ТЧ1_Печ9  = Формат(ВыборкаТЧ1.Сумма     , "ЧЦ=19; ЧДЦ=2; ЧН=");
			ОбластьМакета.Параметры.ТЧ1_Печ10 = "";
			ОбластьМакета.Параметры.ТЧ1_Печ11 = "";
			ОбластьМакета.Параметры.ТЧ1_Печ12 = "";
			ОбластьМакета.Параметры.ТЧ1_Печ13 = "";
			ОбластьМакета.Параметры.ТЧ1_Печ14 = "";
			ОбластьМакета.Параметры.ТЧ1_Печ15 = "несоответствует НД";
			
			
			ТабДокумент.Вывести(ОбластьМакета);
		КонецЦикла;
		
		// Выводим итого ТЧ1 таблицы
		ОбластьМакета                           = Макет.ПолучитьОбласть("ТЧ1_Итого");
		//ТЧ2_Подвал_ПечСуммаБоя                  = ВыборкаТЧ1_Итоги.Сумма;
		ОбластьМакета.Параметры.ТЧ1_Печ7_Итого  = Формат(ВыборкаТЧ1_Итоги.Количество, "ЧЦ=19; ЧДЦ=3; ЧН=");
		ОбластьМакета.Параметры.ТЧ1_Печ9_Итого  = Формат(ВыборкаТЧ1_Итоги.Сумма    , "ЧЦ=19; ЧДЦ=2; ЧН=");
		ОбластьМакета.Параметры.ТЧ1_Печ10_Итого = "";
		ОбластьМакета.Параметры.ТЧ1_Печ12_Итого = "";
		ОбластьМакета.Параметры.ТЧ1_Печ13_Итого = "";
		ТабДокумент.Вывести(ОбластьМакета);
		
		
		// Выводим подвал ТЧ1 таблицы
		ОбластьМакета = Макет.ПолучитьОбласть("ТЧ1_Подвал_Строка1");
		ОбластьМакета.Параметры.ТЧ1_Подвал_ПечПричиныБоя = "внешний вид продукта (произв брак)";
		ОбластьМакета.Параметры.ТЧ1_Подвал_ПечКод        = "";
		ОбластьМакета.Параметры.ТЧ1_Подвал_ПечВиновные   = "производитель";
		ТабДокумент.Вывести(ОбластьМакета);
		
		ТабДокумент.ВывестиГоризонтальныйРазделительСтраниц();
		
		// ТЧ2 ...
			
		// Выводим шапку ТЧ2 таблицы
		ОбластьМакета = Макет.ПолучитьОбласть("ТЧ2_Шапка");
		ТабДокумент.Вывести(ОбластьМакета);
		
		// Выводим заголовок ТЧ2 таблицы
		ОбластьМакета = Макет.ПолучитьОбласть("ТЧ2_Заголовок");
		ТабДокумент.Вывести(ОбластьМакета);
		 	
		// Выводим строки ТЧ2 таблицы
		ОбластьМакета = Макет.ПолучитьОбласть("ТЧ2_СтрокаСредняя");
		
		Для Счетчик = 1 По 3 Цикл
			
			ОбластьМакета.Параметры.ТЧ2_Печ1 = "";
			ОбластьМакета.Параметры.ТЧ2_Печ2 = "";
			ОбластьМакета.Параметры.ТЧ2_Печ3 = "";
			ОбластьМакета.Параметры.ТЧ2_Печ4 = "";
			ОбластьМакета.Параметры.ТЧ2_Печ5 = "";
			ОбластьМакета.Параметры.ТЧ2_Печ6 = "";
			ОбластьМакета.Параметры.ТЧ2_Печ7 = "";
			ОбластьМакета.Параметры.ТЧ2_Печ8 = "";
			ОбластьМакета.Параметры.ТЧ2_Печ9 = "";
			
			ТабДокумент.Вывести(ОбластьМакета);
			
		КонецЦикла;
		
		// Выводим итого ТЧ2 таблицы
		ОбластьМакета = Макет.ПолучитьОбласть("ТЧ2_Итого");
		ОбластьМакета.Параметры.ТЧ2_Печ5_Итого  = "";
		ОбластьМакета.Параметры.ТЧ2_Печ7_Итого  = "";
		ТабДокумент.Вывести(ОбластьМакета);
		
		
		// Выводим подвал ТЧ2 таблицы
		ОбластьМакета = Макет.ПолучитьОбласть("ТЧ2_Подвал_Строка1");
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечЧлен1      = "";
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечЧлен1_Расш = "";
		ТабДокумент.Вывести(ОбластьМакета);

		ОбластьМакета = Макет.ПолучитьОбласть("ТЧ2_Подвал_Строка2");
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечЧлен2      = "";
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечЧлен2_Расш = "";
		ТабДокумент.Вывести(ОбластьМакета);
		
		ОбластьМакета = Макет.ПолучитьОбласть("ТЧ2_Подвал_Строка3");
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечЧлен3      = "";
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечЧлен3_Расш = "";
		ТабДокумент.Вывести(ОбластьМакета);
		
		ОбластьМакета = Макет.ПолучитьОбласть("ТЧ2_Подвал_Строка4");
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечЧлен4      = "";
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечЧлен4_Расш = "";
		ТабДокумент.Вывести(ОбластьМакета);
		
		
		ОбластьМакета = Макет.ПолучитьОбласть("ТЧ2_Подвал_Строка5");
		//ОбластьМакета.Параметры.ТЧ2Подвал_ПечОтнестиНаСчет              = "94 (Недостачи и потери от порчи ценностей)";
		//ОбластьМакета.Параметры.ТЧ2Подвал_ПечОтнестиНаСчет              = "" + ВидСписания.СчетОтнесенияПотерь.СчетЗатрат.Код + " (" + ВидСписания.СчетОтнесенияПотерь.СчетЗатрат.Наименование + ")";
		
		СуммаПрописью = ЧислоПрописью(Цел(ВыборкаТЧ1_Итоги.Сумма), ,"рубль, рубля, рублей, м");
		СуммаПрописью = Сред(СуммаПрописью, 1, СтрДлина(СуммаПрописью) - 3); // уберем копейки и пробел
		//ОбластьМакета.Параметры.ТЧ2_Подвал_ПечСуммаБоя                  = СуммаПрописью;
		//ОбластьМакета.Параметры.ТЧ2_Подвал_ПечСуммаБояКопейки           = Формат(ТЧ2_Подвал_ПечСуммаБоя - Цел(ТЧ2_Подвал_ПечСуммаБоя), "ЧЦ=2 ; ЧДЦ=0; ЧН=");
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечСуммаОприходования        = "";
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечСуммаОприходованияКопейки = "";
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечСуммаЦенностей            = СуммаПрописью;
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечСуммаЦенностейКопейки     = Формат((ВыборкаТЧ1_Итоги.Сумма - Цел(ВыборкаТЧ1_Итоги.Сумма)) * 100, "ЧЦ=2; ЧВН=; ЧН=00");
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечНомерНакладной            = ВыборкаТЧ1_Итоги.Номер + "  от  " + Формат(ВыборкаТЧ1_Итоги.Дата, "ДФ=dd.MM.yyyy");
		//ОбластьМакета.Параметры.ТЧ2_Подвал_ПечЧисло                     = "";
		//ОбластьМакета.Параметры.ТЧ2_Подвал_ПечМесяц                     = "";
		//ОбластьМакета.Параметры.ТЧ2_Подвал_ПечГод                       = "";
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечДолжность                 = "";
		ОбластьМакета.Параметры.ТЧ2_Подвал_ПечРасшифровка               = "";

		ТабДокумент.Вывести(ОбластьМакета);
				
	КонецЦикла;

	Если ПривилегированныйРежим() Тогда
		УстановитьПривилегированныйРежим(Ложь);
	КонецЕсли;
	
	// Зададим параметры макета
	ТабДокумент.ПолеСверху = 0;
	ТабДокумент.ПолеСлева  = 0;
	ТабДокумент.ПолеСнизу  = 0;
	ТабДокумент.ПолеСправа = 0;
	
	ТабДокумент.ОриентацияСтраницы=ОриентацияСтраницы.Ландшафт;
	ТабДокумент.АвтоМасштаб = Истина;

	Возврат ТабДокумент;	
КонецФункции	

Функция ПечатьПретензияТОРГ15(массивОбъектов,ОбъектыПечати)
	УстановитьПривилегированныйРежим(Истина);
	
	ТабДокумент = Новый ТабличныйДокумент;
	Макет = УправлениеПечатью.ПолучитьМакет("Документ.РасходнаяНакладная.ПретензияТОРГ15");
		
	Запрос1 = Новый Запрос;
	Запрос1.Текст = "ВЫБРАТЬ
	                |	РасходнаяНакладнаяСостав.Ссылка.Номер КАК Номер,
	                |	РасходнаяНакладнаяСостав.Ссылка.Дата КАК Дата,
	                |	РасходнаяНакладнаяСостав.Ссылка.Фирма КАК Фирма,
	                |	РасходнаяНакладнаяСостав.Ссылка.СтруктурнаяЕдиница КАК СтруктурнаяЕдиница,
	                |	РасходнаяНакладнаяСостав.Номенклатура,
	                |	РасходнаяНакладнаяСостав.Номенклатура.Наименование КАК ТоварНаименование,
	                |	РасходнаяНакладнаяСостав.Номенклатура.Код КАК Код,
	                |	РасходнаяНакладнаяСостав.ЕдиницаИзмерения,
	                |	РасходнаяНакладнаяСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.ПолноеНаименование КАК ЕдИзмНаименование,
	                |	РасходнаяНакладнаяСостав.ЕдиницаИзмерения.ЕдиницаПоКлассификатору.Код КАК КодОКЕИ,
	                |	"""" КАК Артикул,
	                |	"""" КАК Сорт,
	                |	РасходнаяНакладнаяСостав.Количество КАК Количество,
	                |	РасходнаяНакладнаяСостав.Цена,
	                |	РасходнаяНакладнаяСостав.Сумма КАК Сумма
	                |ИЗ
	                |	Документ.РасходнаяНакладная.Состав КАК РасходнаяНакладнаяСостав
	                |ГДЕ
	                |	РасходнаяНакладнаяСостав.Ссылка В(&Ссылка)
	                |	И РасходнаяНакладнаяСостав.Ссылка.Возврат = ИСТИНА
	                |ИТОГИ
	                |	СУММА(Количество),
	                |	СУММА(Сумма)
	                |ПО
	                |	РасходнаяНакладнаяСостав.Ссылка";
		
	Запрос1.Параметры.Вставить("Ссылка", МассивОбъектов);
	
	ВыборкаТЧ1_Итоги = Запрос1.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	Пока ВыборкаТЧ1_Итоги.Следующий() Цикл
		
		ОписаниеОрганизации = ОбработкаПечатиСервер.СведенияОЮрФизЛице(ВыборкаТЧ1_Итоги.Фирма, ВыборкаТЧ1_Итоги.Дата, ВыборкаТЧ1_Итоги.СтруктурнаяЕдиница);
		Руководители        = ОбработкаПечатиСервер.ОтветственныеЛицаОрганизационнойЕдиницы(ВыборкаТЧ1_Итоги.Фирма, ВыборкаТЧ1_Итоги.Дата, ВыборкаТЧ1_Итоги.СтруктурнаяЕдиница);

		// Претензия
		ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
		
		ОбластьМакета.Параметры.Шапка_Фирма = ВыборкаТЧ1_Итоги.Фирма;
				
		ОбластьМакета.Параметры.Шапка_Номер = ВыборкаТЧ1_Итоги.Номер;
		ОбластьМакета.Параметры.Шапка_Дата = Формат(ВыборкаТЧ1_Итоги.Дата, "ДФ=dd.MM.yyyy");
		
		ОбластьМакета.Параметры.Шапка_СуммаРуб = Цел(ВыборкаТЧ1_Итоги.Сумма);
		ОбластьМакета.Параметры.Шапка_СуммаКоп = (ВыборкаТЧ1_Итоги.Сумма - Цел(ВыборкаТЧ1_Итоги.Сумма)) * 100;
		
		ТабДокумент.Вывести(ОбластьМакета);	
	
	КонецЦикла;

	Если ПривилегированныйРежим() Тогда
		УстановитьПривилегированныйРежим(Ложь);
	КонецЕсли;
	
	// Зададим параметры макета
	ТабДокумент.ПолеСверху = 0;
	ТабДокумент.ПолеСлева  = 0;
	ТабДокумент.ПолеСнизу  = 0;
	ТабДокумент.ПолеСправа = 0;
	
	ТабДокумент.АвтоМасштаб = Истина;

	Возврат ТабДокумент;
КонецФункции	

Функция ТекстЗапросаДанныеДляПечатиСчетовФактур(НомераТаблиц) Экспорт

	НомераТаблиц.Вставить("ВременнаяТаблицаНаличиеТоваров", НомераТаблиц.Количество());
	НомераТаблиц.Вставить("Реквизиты",       НомераТаблиц.Количество());
	НомераТаблиц.Вставить("ВременнаяТаблицаДокумента", НомераТаблиц.Количество());
	
	ТекстЗапроса = 
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	ТаблицаТовары.Ссылка КАК Ссылка
	|ПОМЕСТИТЬ НаличиеТоваров
	|ИЗ
	|	Документ.РасходнаяНакладная.Состав КАК ТаблицаТовары
	|ГДЕ
	|	ТаблицаТовары.Ссылка = &ДокументОснование
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Ссылка
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Реквизиты.Дата КАК ДатаОснования,
	|	Реквизиты.Фирма КАК Фирма,
	|	Реквизиты.СтруктурнаяЕдиница КАК СтруктурнаяЕдиница,
	|	Реквизиты.Фирма КАК Поставщик,
	|	ЕСТЬNULL(ЗапросПоКПП.КПП, Реквизиты.Фирма.КПП) КАК КППпоставщика,
	|	ВЫБОР
	|		КОГДА Реквизиты.Грузополучатель = ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|				ИЛИ Реквизиты.Грузополучатель = НЕОПРЕДЕЛЕНО
	|			ТОГДА ВЫБОР
	|					КОГДА Реквизиты.Контрагент ССЫЛКА Справочник.СтруктурныеЕдиницы
	|							И Реквизиты.Контрагент.Организация <> ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|						ТОГДА Реквизиты.Контрагент.Организация
	|					ИНАЧЕ Реквизиты.Контрагент
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА Реквизиты.Грузополучатель ССЫЛКА Справочник.СтруктурныеЕдиницы
	|						И Реквизиты.Грузополучатель.Организация <> ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|					ТОГДА Реквизиты.Грузополучатель.Организация
	|				ИНАЧЕ Реквизиты.Грузополучатель
	|			КОНЕЦ
	|	КОНЕЦ КАК Грузополучатель,
	|	ВЫБОР
	|		КОГДА Реквизиты.Контрагент ССЫЛКА Справочник.СтруктурныеЕдиницы
	|				И Реквизиты.Контрагент.Организация <> ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|			ТОГДА Реквизиты.Контрагент.Организация
	|		ИНАЧЕ Реквизиты.Контрагент
	|	КОНЕЦ КАК Покупатель,
	|	ВЫБОР
	|		//+Зернятко А.В.@06.11.2013 - //RSS-341. Фактический адрес грузоотправителя = Адрес СЕ
	|		КОГДА Реквизиты.Грузоотправитель = НЕОПРЕДЕЛЕНО 
	|			ТОГДА Реквизиты.СтруктурнаяЕдиница
	|		КОГДА Реквизиты.Грузоотправитель = ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|			ТОГДА Реквизиты.СтруктурнаяЕдиница
	|		КОГДА Реквизиты.Грузоотправитель = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|			ТОГДА Реквизиты.СтруктурнаяЕдиница
	|		///Зернятко А.В.@ - конец блока	
	|		КОГДА Реквизиты.Грузоотправитель = ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|			ТОГДА ""он же""
	|		ИНАЧЕ Реквизиты.Грузоотправитель
	|	КОНЕЦ КАК Грузоотправитель,
	|	Реквизиты.Валюта КАК Валюта,
	|	ВЫБОР
	|		КОГДА НаличиеТоваров.Ссылка ЕСТЬ NULL 
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК ЕстьТовары
	|ИЗ
	|	Документ.РасходнаяНакладная КАК Реквизиты
	|		ЛЕВОЕ СОЕДИНЕНИЕ НаличиеТоваров КАК НаличиеТоваров
	|		ПО Реквизиты.Ссылка = НаличиеТоваров.Ссылка
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
	|			СтруктурныеЕдиницыДополнительныеРеквизиты.Ссылка КАК СтруктурнаяЕдиница,
	|			СтруктурныеЕдиницыДополнительныеРеквизиты.Значение КАК КПП
	|		ИЗ
	|			Справочник.СтруктурныеЕдиницы.ДополнительныеРеквизиты КАК СтруктурныеЕдиницыДополнительныеРеквизиты
	|		ГДЕ
	|			СтруктурныеЕдиницыДополнительныеРеквизиты.Свойство = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ДополнительныеРеквизитыСтруктурныхЕдиниц.КППОбособленногоПодразделения)) КАК ЗапросПоКПП
	|		ПО Реквизиты.СтруктурнаяЕдиница = ЗапросПоКПП.СтруктурнаяЕдиница
	|ГДЕ
	|	Реквизиты.Ссылка = &ДокументОснование
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	1 КАК НомерТабЧасти,
	|	ТаблицаТовары.НомерСтроки КАК НомерСтроки,
	|	ТаблицаТовары.Номенклатура КАК Товар,
	|	ТаблицаТовары.Номенклатура.Наименование КАК ТоварНаименование,
	|	ТаблицаТовары.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	|	ТаблицаТовары.Количество КАК Количество,
	|	ТаблицаТовары.Цена КАК Цена,
	|	ТаблицаТовары.Сумма КАК Сумма,
	|	ТаблицаТовары.СуммаНДС КАК СуммаНДС,
	|	ТаблицаТовары.СтавкаНДС КАК СтавкаНДС,
	|	ЛОЖЬ КАК ЭтоУслуга,
	|	ИСТИНА КАК СуммаВключаетНДС,
	|	ТаблицаТовары.Ссылка КАК Ссылка
	|ПОМЕСТИТЬ ТаблицаДокумента
	|ИЗ
	|	Документ.РасходнаяНакладная.Состав КАК ТаблицаТовары
	|ГДЕ
	|	ТаблицаТовары.Ссылка = &ДокументОснование";
	
	Возврат ТекстЗапроса + ОбщегоНазначенияПереопределяемый.ТекстРазделителяЗапросовПакета();

КонецФункции

