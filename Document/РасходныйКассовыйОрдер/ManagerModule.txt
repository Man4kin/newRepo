
Функция ПечатьКО2(МассивОбъектов,ОбъектыПечати) экспорт
	ТабличныйДокумент = Новый ТабличныйДокумент;
	//Макет = Документы.РасходныйКассовыйОрдер.ПолучитьМакет("КО2");
	Макет = УправлениеПечатью.ПолучитьМакет("Документ.РасходныйКассовыйОрдер.КО2");
	Макет.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_РасходныйКассовыйОрдер_РасходныйКассовыйОрдер";
	НомерСтрокиНачало = 0;
	для каждого док из массивОбъектов цикл
		Запрос = Новый Запрос();
		Запрос.УстановитьПараметр("ТекущийДокумент", Док.Ссылка);
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	РасходныйКассовыйОрдер.Номер КАК Номер,
		|	РасходныйКассовыйОрдер.Дата КАК ДатаДокумента,
		|	РасходныйКассовыйОрдер.Фирма КАК Организация,
		|	РасходныйКассовыйОрдер.СтруктурнаяЕдиница КАК СтруктурнаяЕдиница,
		|	РасходныйКассовыйОрдер.СтруктурнаяЕдиница КАК ПредставлениеПодразделения,
		|	РасходныйКассовыйОрдер.Выдать КАК Выдать,
		|	РасходныйКассовыйОрдер.Основание КАК Основание,
		|	РасходныйКассовыйОрдер.Приложение КАК Приложение,
		//popn+
		//  РасходныйКассовыйОрдер.КлассификаторДДС.Счет КАК Дебет,
		|   РасходныйКассовыйОрдер.СтатьяДвиженияДенежныхСредств.СчетУчета как Дебет,
		//popn-
		|	РасходныйКассовыйОрдер.Сумма КАК Сумма
		|ИЗ
		|	Документ.РасходныйКассовыйОрдер КАК РасходныйКассовыйОрдер
		|ГДЕ
		|	РасходныйКассовыйОрдер.Ссылка = &ТекущийДокумент";
		Валюта = Док.ссылка.валюта;
		ВыборкаДляПечати = Запрос.Выполнить().Выбрать();
		ВыборкаДляПечати.Следующий();
		ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
		ОбластьМакета.Параметры.Заполнить(ВыборкаДляПечати);
		СведенияОбОрганизации = обработкаПечатиСервер.СведенияОЮрФизЛице(ВыборкаДляПечати.Организация,Док.ссылка.Дата,Док.Ссылка.СтруктурнаяЕдиница);
		ПредставлениеОрганизации =  обработкаПечатиСервер.ОписаниеОрганизации(СведенияОбОрганизации,"ПолноеНаименование,ЮридическийАдрес,Телефоны");
		ОбластьМакета.Параметры.ПредставлениеОрганизации = ПредставлениеОрганизации;
		ОбластьМакета.Параметры.НомерДокумента = ОбработкаПечатиСервер.ПолучитьНомерНаПечать(Док.ссылка);
		ОбластьМакета.Параметры.Сумма = ОбработкаПечатиСервер.ФорматироватьСуммуПлатежногоДокумента(ВыборкаДляПечати.Сумма,Ложь);
		ОбластьМакета.Параметры.фиополучателя = ВыборкаДляПечати.выдать;
		ОбластьМакета.Параметры.СуммаПрописью =ЧислоПрописью(ВыборкаДляПечати.Сумма,,"рубль, рубля, рублей, м, копейка, копейки, копеек, ж, 2");
		
		//*Зернятко А.В.@06.11.2013 - //AKB-374. Ответственные лица СЕ
		//Руководители = ОбработкаПечатиСервер.ОтветственныеЛицаОрганизационнойЕдиницы(Док.ссылка.фирма, Док.ссылка.МоментВремени());
		Руководители = ОбработкаПечатиСервер.ОтветственныеЛицаОрганизационнойЕдиницы(ВыборкаДляПечати.Организация, Док.ссылка.МоментВремени(), ВыборкаДляПечати.СтруктурнаяЕдиница);
		///Зернятко А.В.@ - конец блока
		ОбластьМакета.Параметры.КредитСубСЧет = "50.01";
		ОбластьМакета.Параметры.ДебетСубСчет = ВыборкаДляПечати.Дебет;
		ОбластьМакета.Параметры.ФИОРуководителя		  = Руководители.ФИОРуководителя;
		ОбластьМакета.Параметры.ДолжностьРуководителя = Руководители.РуководительДолжность;
		ОбластьМакета.Параметры.ФИОГлавногоБухгалтера = Руководители.ФИОГлавногоБухгалтера;
		ОбластьМакета.Параметры.ФИОКассира            = Руководители.ФИОКассира;
		ТабличныйДокумент.Вывести(ОбластьМакета);
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
		НомерСтрокиНачало, ОбъектыПечати,Док.Ссылка);
		НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы+1;
	конеццикла;
	Возврат ТабличныйДокумент;
КонецФункции

Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм,
	ОбъектыПечати, ПараметрыВывода) Экспорт
	ПараметрыВывода.ДоступнаПечатьПоКомплектно = Истина;
	Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "КО2") Тогда
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
		"КО2", "КО-2", ПечатьКО2(массивОбъектов,ОбъектыПечати));
	ИначеЕсли УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "Приложение8") Тогда
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм,
		"Приложение8", "Приложение № 8", ПечатьПриложение8(массивОбъектов,ОбъектыПечати));
	КонецЕсли;
КонецПроцедуры



Функция ПечатьПриложение8(МассивОбъектов,ОбъектыПечати) экспорт
	ТабличныйДокумент = Новый ТабличныйДокумент;
	НомерСтрокиНачало = 0;
	для каждого док из массивОбъектов цикл
		Запрос = Новый ЗАпрос;
		Запрос.Текст = "ВЫБРАТЬ
		|	РасходныйКассовыйОрдер.Дата КАК Дата,
		|	РасходныйКассовыйОрдер.СтатьяДвиженияДенежныхСредств.СчетУчета КАК Дебет,
		|	РасходныйКассовыйОрдер.Сумма КАК Сумма,
		|	РасходныйКассовыйОрдер.Фирма,
		|	РасходныйКассовыйОрдер.Валюта
		|ИЗ
		|	Документ.РасходныйКассовыйОрдер КАК РасходныйКассовыйОрдер
		|ГДЕ
		|	РасходныйКассовыйОрдер.Ссылка = &ТекущийДокумент";
		Запрос.УстановитьПараметр("ТекущийДокумент",Док.ССылка);
		Рез = Запрос.Выполнить();
		Выборка = Рез.Выбрать();
		Валюта = Выборка.Валюта;
		Если Не ЗначениеЗаполнено(Валюта) тогда
			Валюта = Справочники.Валюты.ПустаяСсылка();
		Конецесли;
		Если Рез.Пустой() тогда
			Продолжить;
		КонецЕсли;
		Выборка.Следующий();
		//Макет = Документы.РасходныйКассовыйОрдер.ПолучитьМакет("Приложение8Лист1");
		Макет = УправлениеПечатью.ПолучитьМакет("Документ.РасходныйКассовыйОрдер.Приложение8Лист1");
		Макет.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_РасходныйКассовыйОрдер_Приложение8Лист1";
		Область = Макет.ПолучитьОбласть("ОбластьДокумента");
		Область.Параметры.Фирма = Выборка.Фирма;
		Область.параметры.Дата = ВЫборка.Дата;
		Область.Параметры.СуммаПрописью =ЧислоПрописью(Выборка.Сумма,,"рубль, рубля, рублей, м, копейка, копейки, копеек, ж, 2");
		
		Область.Параметры.СчетДебета = Выборка.Дебет;
		Область.Параметры.СчетКредита = "50.01";
		ТабличныйДокумент.Вывести(Область);	
		//Макет = Документы.РасходныйКассовыйОрдер.ПолучитьМакет("Приложение8Лист2и4");
		Макет = УправлениеПечатью.ПолучитьМакет("Документ.РасходныйКассовыйОрдер.Приложение8Лист2и4");
		Область = Макет.ПолучитьОбласть("ОбластьДокумента");
		ТабличныйДокумент.Вывести(Область);
		//Макет = Документы.РасходныйКассовыйОрдер.ПолучитьМакет("Приложение8Лист3");
		Макет = УправлениеПечатью.ПолучитьМакет("Документ.РасходныйКассовыйОрдер.Приложение8Лист3");
		Макет.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_РасходныйКассовыйОрдер_Приложение8Лист3";
		Область = Макет.ПолучитьОбласть("ОбластьДокумента");
		Область.Параметры.Фирма = Выборка.Фирма;
		Область.параметры.Дата = ВЫборка.Дата;
		Область.Параметры.СуммаПрописью =ЧислоПрописью(Выборка.Сумма,,"рубль, рубля, рублей, м, копейка, копейки, копеек, ж, 2");
		
		Область.Параметры.СчетДебета = Выборка.Дебет;
		Область.Параметры.СчетКредита = "50.01";
		ТабличныйДокумент.Вывести(Область);	
		//Макет = Документы.РасходныйКассовыйОрдер.ПолучитьМакет("Приложение8Лист2и4");
		Макет = УправлениеПечатью.ПолучитьМакет("Документ.РасходныйКассовыйОрдер.Приложение8Лист2и4");
		Область = Макет.ПолучитьОбласть("ОбластьДокумента");
		ТабличныйДокумент.Вывести(Область);
		//Макет = Документы.РасходныйКассовыйОрдер.ПолучитьМакет("Приложение8Лист5");
		Макет = УправлениеПечатью.ПолучитьМакет("Документ.РасходныйКассовыйОрдер.Приложение8Лист5");
		Макет.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_РасходныйКассовыйОрдер_Приложение8Лист5";
		Область = Макет.ПолучитьОбласть("ОбластьДокумента");
		Область.Параметры.Фирма = Выборка.Фирма;
		Область.параметры.Дата = ВЫборка.Дата;
		Область.Параметры.СуммаПрописью =ЧислоПрописью(Выборка.Сумма,,"рубль, рубля, рублей, м, копейка, копейки, копеек, ж, 2");
		Область.Параметры.СчетДебета = Выборка.Дебет;
		Область.Параметры.СчетКредита = "50.01";
		ТабличныйДокумент.Вывести(Область);	
		//Макет = Документы.РасходныйКассовыйОрдер.ПолучитьМакет("Приложение8Лист6");
		Макет = УправлениеПечатью.ПолучитьМакет("Документ.РасходныйКассовыйОрдер.Приложение8Лист6");
		Область = Макет.ПолучитьОбласть("ОбластьДокумента");
		ТабличныйДокумент.Вывести(Область);

	конеццикла;
	Возврат ТабличныйДокумент;
КонецФункции

