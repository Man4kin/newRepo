
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	ПолноеИмяФормы = "Справочник.УчетныеЗаписиЭлектроннойПочты.ФормаОбъекта";
	
	СистемнаяУчетнаяЗапись = СистемнаяУчетнаяЗаписьСервер();
	Если СистемнаяУчетнаяЗапись.Пустая() Тогда
		Сообщить("В параметрах текущей структурной единицы не задана системная учетная запись электронной почты. Необходима настройка учетной записи в RS.Centre.");
		Возврат;
	КонецЕсли;
	
	ПараметрыФормы = Новый Структура("Ключ",СистемнаяУчетнаяЗапись);
	
	ВладелецФормы = ПараметрыВыполненияКоманды.Источник;
	УникальностьФормы = ПараметрыВыполненияКоманды.Уникальность;
	
	#Если ВебКлиент Тогда
	ОкноФормы = ПараметрыВыполненияКоманды.Окно;
	#Иначе
	ОкноФормы = ПараметрыВыполненияКоманды.Источник;
	#КонецЕсли
	
	ОткрытьФорму(ПолноеИмяФормы, ПараметрыФормы, ВладелецФормы, УникальностьФормы, ОкноФормы);
	
КонецПроцедуры

&НаСервере
Функция СистемнаяУчетнаяЗаписьСервер()
	Возврат УправлениеПараметрамиСЕСервер.ПолучитьЗначениеСвойства(ПланыВидовХарактеристик.ПараметрыСтруктурныхЕдиниц.УчетнаяЗаписьЭлектроннойПочты, ПараметрыСеанса.ТекущаяСтруктурнаяЕдиница);
КонецФункции
