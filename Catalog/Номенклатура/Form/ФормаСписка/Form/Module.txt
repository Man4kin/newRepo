
&НаКлиенте
Процедура СоздатьГруппуВыполнить()
	Родитель = ПолучитьТекущегоРодителя(Элементы.Список.ТекущаяСтрока);
	ОткрытьФорму("Справочник.Номенклатура.Форма.ФормаГруппы",Новый Структура("Родитель", Родитель));
КонецПроцедуры

&НаСервере
Функция ПолучитьТекущегоРодителя(Знач Родитель)
	Если Родитель = Неопределено Тогда
		Возврат Справочники.Номенклатура.ПустаяСсылка();
	КонецЕсли;
	Родитель=Родитель.Родитель;
	Пока НЕ Родитель.Пустая() И Родитель.Группа<>1  Цикл
		Родитель=Родитель.Родитель;
	КонецЦикла;	
	Возврат Родитель;
КонецФункции	

&НаКлиенте
Процедура ПоказатьГруппыВПодборе(Команда)
	если элементы.СписокСписок.Пометка тогда
		элементы.кнГруппы.пометка = не элементы.кнГруппы.пометка;
	иначе
		элементы.кнГруппы.Пометка = истина;
	конецесли;
	флаг = Элементы.кнГруппы.пометка;
	ВЫполнить("ОбработкаТабличныхЧастейКлиент.ОтображениеГрупп(Список,флаг)");
КонецПроцедуры

&НаКлиенте
Процедура Дерево(Команда)
	обработкатабличныхчастейклиент.ОтображениеДинамическогоСпискаДерево(ЭтаФорма,"Список");	
КонецПроцедуры


&НаКлиенте
Процедура Иерархия(Команда)
	обработкатабличныхчастейклиент.отображениединамическогоспискаиерархия(этаформа,"Список");	
КонецПроцедуры


&НаКлиенте
Процедура Список(Команда)
	обработкатабличныхчастейклиент.ОтображениеДинамическогоСпискаСписок(этаформа,"Список");	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	ОбщегоНазначенияСервер.ЗапретМодификацииОбъектов(Элементы.Список);
	ДополнительныеОтчетыИОбработки.ПриСозданииНаСервере(ЭтаФорма);
КонецПроцедуры

&НаКлиенте
Процедура ПриЗакрытии()
	СохранитьПараметрыПодбора();
КонецПроцедуры

&НаСервере
Процедура 	СохранитьПараметрыПодбора()
	ПОдборНоменклатурыСервер.СохранитьПараметрыПодбора("Справочник.Номенклатура",ЭтаФорма.ИмяФормы,ЭтаФорма.Элементы,"Список");
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	ЗагрузитьНастройкиПодбора();
	КомпонентаУстановлена = РаботаСоСканеромШККлиент.ПроинициализироватьКомпоненту();
КонецПроцедуры


&НаКлиенте
процедура ЗагрузитьНастройкиПодбора()
	Настройки = ПолучитьНастройкуПодбора();
	ОбработкаТабличныхЧастейКлиент.загрузитьнастройкиподбора(ЭтаФорма,Настройки,"Список");
конецпроцедуры

&НаСервере
Функция получитьНастройкуПодбора()
	возврат подборНоменклатурыСервер.ПолучитьНастройкуподбора("Справочник.Номенклатура",ЭтаФорма.ИмяФормы);	
конецфункции


&НаКлиенте
Процедура ВнешнееСобытие(Источник, Событие, Данные)
	Если Источник = "BarCodeScaner" И Событие = "BarCodeValue" Тогда
		Если Не ВводДоступен() Тогда
			КомпонентаСканераШК.СобытиеОбработано();
			Возврат;   
		КонецЕсли;
		РаботаСоСканеромШККлиент.ОбработкаШтрихКодаВСпискеНоменклатуры(Данные,Список);
		КомпонентаСканераШК.СобытиеОбработано();
	КонецЕсли;
КонецПроцедуры


