
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Дерево = УправлениеСвойствамиСервер.ЗаполнитьДеревоРеквизитов(Объект.Ссылка,"Номенклатура","ДополнительныеРеквизитыНоменклатуры",Ложь);
	ЗначениеВДанныеФормы(Дерево,ДеревоСвойств);
	Дерево = УправлениеСвойствамиСервер.ЗаполнитьДеревоСертификатов(Объект.Ссылка);
	ЗначениеВДанныеФормы(Дерево,ДеревоСертификатов);
	Если ЗначениеЗаполнено(Объект.ФорматPLU) Тогда
		Элементы.Код.Ширина = 5;
		Элементы.ФорматPLU.Видимость = Истина;
		Элементы.ПрефиксPLU.Видимость = Истина;
	КонецЕсли;	
	Если Объект.ВидТовара = Перечисления.ВидыТоваров.Набор ИЛИ  Объект.ВидТовара = Перечисления.ВидыТоваров.НаборПоставщика Тогда
		Элементы.СтраницаСоставаНабора.Видимость = Истина;
	КонецЕсли;	
	Элементы.УчетПоСоставу.Доступность = Объект.ВидТовара = ПредопределенноеЗначение("Перечисление.ВидыТоваров.Набор") ИЛИ Объект.ВидТовара = ПредопределенноеЗначение("Перечисление.ВидыТоваров.НаборПоставщика");
	Элементы.ДеревоСертификатов.ТолькоПросмотр = НЕ (РольДоступна(Метаданные.Роли.ПолныеПрава) ИЛИ РольДоступна(Метаданные.Роли.ДобавлениеИзменениеБазовойНСИ));
	Элементы.ДеревоСвойств.ТолькоПросмотр = НЕ (РольДоступна(Метаданные.Роли.ПолныеПрава) ИЛИ РольДоступна(Метаданные.Роли.ДобавлениеИзменениеБазовойНСИ));
	ДополнительныеОтчетыИОбработки.ПриСозданииНаСервере(ЭтаФорма);
КонецПроцедуры

&НаКлиенте
Процедура ДеревоСвойствПриНачалеРедактирования(Элемент, НоваяСтрока, Копирование)
	УправлениеСвойствамиКлиент.ДеревоСвойствПриНачалеРедактирования(Элемент,Объект);
КонецПроцедуры

&НаКлиенте
Процедура ДеревоСвойствПриИзменении(Элемент)
	Модифицированность = Истина;
КонецПроцедуры

&НаКлиенте
Процедура ДеревоСвойствПередНачаломИзменения(Элемент, Отказ)
	Если Элемент.ТекущиеДанные.Картинка = 1 Тогда
		Отказ = Истина;
	КонецЕсли;
КонецПроцедуры

&НаСервере
Процедура ПередЗаписьюНаСервере(Отказ, ТекущийОбъект)
	УправлениеСвойствамиСервер.ПеренестиЗначенияСвойств(ТекущийОбъект.ДополнительныеРеквизиты, РеквизитФормыВЗначение("ДеревоСвойств"));
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	Если Объект.Группа = 1 Тогда
		Отказ = Истина;
		ОткрытьФорму("Справочник.Номенклатура.Форма.ФормаГруппы",Новый Структура("Ключ", Объект.Ссылка));
	КонецЕсли;	
КонецПроцедуры

&НаКлиенте
Процедура ДеревоСертификатовПриНачалеРедактирования(Элемент, НоваяСтрока, Копирование)
	Элемент.ПодчиненныеЭлементы.ДеревоСертификатовЗначение.ОграничениеТипа = Элемент.ТекущиеДанные.ТипЗначенияСвойства;
КонецПроцедуры

&НаСервере
Процедура ПриЗаписиНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)
	УправлениеСвойствамиСервер.ПеренестиЗначенияСертификатов(ТекущийОбъект.Ссылка, РеквизитФормыВЗначение("ДеревоСертификатов"));
	Задача = ЭтаФорма.Параметры.ВыполняемаяЗадача;
	Если ЗначениеЗаполнено(Задача) Тогда
		УправлениеБизнесПроцессамиСервер.ВыполнитьЗадачу(Задача);
	КонецЕсли;	
КонецПроцедуры

&НаКлиенте
Процедура ПослеЗаписи(ПараметрыЗаписи)
	Задача = ЭтаФорма.Параметры.ВыполняемаяЗадача;
	Если ЗначениеЗаполнено(Задача) Тогда
		Если ОбщегоНазначения.ПолучитьЗначениеРеквизита(Задача,"Выполнена") Тогда
			Оповестить("ЗадачаВыполнена");
		КонецЕсли;	
	КонецЕсли;	
КонецПроцедуры

&НаКлиенте
Процедура ВидТовараПриИзменении(Элемент)
	Элементы.УчетПоСоставу.Доступность = Объект.ВидТовара = ПредопределенноеЗначение("Перечисление.ВидыТоваров.Набор") ИЛИ Объект.ВидТовара = ПредопределенноеЗначение("Перечисление.ВидыТоваров.НаборПоставщика");
КонецПроцедуры

&НаКлиенте
Процедура ДеревоСертификатовЗначениеПриИзменении(Элемент)
	ТекущиеДанные = Элементы.ДеревоСертификатов.ТекущиеДанные;
	ТекущиеДанные.ДатаС = ОбщегоНазначенияСервер.ПолучитьСвойствоПоСсылке(ТекущиеДанные.Значение,"ДатаС");
	ТекущиеДанные.ДатаПо = ОбщегоНазначенияСервер.ПолучитьСвойствоПоСсылке(ТекущиеДанные.Значение,"ДатаПо");
КонецПроцедуры


