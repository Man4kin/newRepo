Процедура ВывестиШтрихкодВТабличныйДокумент(ТабличныйДокумент, Макет, Знач ОбластьМакета, Ссылка) Экспорт
	ВнешняяКомпонента = ШтриховыеКоды.ПодключитьВнешнююКомпонентуПечатиШтрихкода();
	Если ВнешняяКомпонента = Неопределено Тогда
		ВызватьИсключение НСтр("ru = 'Ошибка подключения внешней компоненты печати штрихкода!'");
	КонецЕсли;
	
	УникальныйИдентификатор = Строка(Ссылка.УникальныйИдентификатор()); 
	
	Эталон = Обработки.ПечатьЦенниковИЭтикеток.ПолучитьМакет("Эталон");
	КоличествоМиллиметровВПикселе = Эталон.Рисунки.Квадрат100Пикселей.Высота / 100;
	
	ПараметрыШтрихкода = Новый Структура;
	ПараметрыШтрихкода.Вставить("Ширина",          Окр(ОбластьМакета.Рисунки.КартинкаШтрихкода.Ширина / КоличествоМиллиметровВПикселе));
	ПараметрыШтрихкода.Вставить("Высота",          Окр(ОбластьМакета.Рисунки.КартинкаШтрихкода.Высота / КоличествоМиллиметровВПикселе));
	ПараметрыШтрихкода.Вставить("Штрихкод",        УникальныйИдентификатор);
	ПараметрыШтрихкода.Вставить("ТипКода",         4); // Code128
	ПараметрыШтрихкода.Вставить("АвтоТип",         Ложь);
	ПараметрыШтрихкода.Вставить("ОтображатьТекст", Ложь);
	ПараметрыШтрихкода.Вставить("РазмерШрифта",    8);
	
	ОбластьМакета.Рисунки.КартинкаШтрихкода.Картинка = ШтриховыеКоды.ПолучитьКартинкуШтрихкода(ВнешняяКомпонента, ПараметрыШтрихкода);
КонецПроцедуры

//ШиловМВ 21.07.14 №000121704{{
Процедура ПечатьАдресовШК(МассивАдресов,Таб) Экспорт
	ВнешняяКомпонента = ШтриховыеКоды.ПодключитьВнешнююКомпонентуПечатиШтрихкода();
	Если ВнешняяКомпонента = Неопределено Тогда
		ВызватьИсключение НСтр("ru = 'Ошибка подключения внешней компоненты печати штрихкода!'");
	КонецЕсли;
	КолСтраниц=0;
	МакетАдрес=ПолучитьМакет("МакетАдр");
	ОбластьАдрес=МакетАдрес.ПолучитьОбласть("Адрес");
	Для каждого Адрес Из МассивАдресов Цикл
		ОбластьАдрес.Параметры.Адрес=Адрес.Код;
		ВывестиШтрихкодВТабличныйДокумент(Таб,МакетАдрес,ОбластьАдрес,Адрес);
		Таб.Вывести(ОбластьАдрес);
		КолСтраниц=КолСтраниц+1;
		Если КолСтраниц>=4 Тогда
			Таб.ВывестиГоризонтальныйРазделительСтраниц();
			КолСтраниц=0;
		КонецЕсли;
	КонецЦикла;
КонецПроцедуры
//ШиловМВ 21.07.14 №000121704}}