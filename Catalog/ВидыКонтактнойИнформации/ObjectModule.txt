
Процедура ПередЗаписью(Отказ)
	
	Если ЭтоНовый() ИЛИ (Порядок = 0) Тогда
		
		Запрос = Новый Запрос;
		Запрос.Текст =
		"ВЫБРАТЬ
		|	МАКСИМУМ(ВидыКонтактнойИнформации.Порядок) КАК Порядок
		|ИЗ
		|	Справочник.ВидыКонтактнойИнформации КАК ВидыКонтактнойИнформации
		|ГДЕ
		|	ВидыКонтактнойИнформации.Родитель = &Родитель";
		
		Запрос.УстановитьПараметр("Родитель", Родитель);
		Выборка = Запрос.Выполнить().Выбрать();
		Выборка.Следующий();
		Порядок = ?(Выборка.Порядок = Null, 1, Выборка.Порядок + 1);
		
	КонецЕсли;
	
КонецПроцедуры
