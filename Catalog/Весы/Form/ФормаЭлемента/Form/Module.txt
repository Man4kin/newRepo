
&НаКлиенте
Процедура РодительПриИзменении(Элемент)
	Если Объект.Родитель.Пустая() Тогда
		Элементы.Отдел.Доступность = Истина;
		Элементы.ПодключаемоеОборудование.Доступность = Ложь;
	Иначе
		Элементы.Отдел.Доступность = Ложь;
		Элементы.ПодключаемоеОборудование.Доступность = Истина;	
	КонецЕсли
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если НЕ ЗначениеЗаполнено(Параметры.Ключ) Тогда
		Элементы.Родитель.Доступность = Истина;
	КонецЕсли;
	Если НЕ Объект.Родитель.Пустая() Тогда
		Элементы.Отдел.Доступность = Ложь;
		
		Если Объект.Родитель.Отдел = Истина Тогда
			Объект.Отдел = Истина;
		КонецЕсли;	
	Иначе
		Элементы.ПодключаемоеОборудование.Доступность = Ложь;
	КонецЕсли	
КонецПроцедуры

//&НаКлиенте
//Процедура ПередЗаписью(Отказ, ПараметрыЗаписи)
//	Если Объект.Ссылка.Пустая() = Ложь Тогда
//		РодительСсылки = ПолучитьРодителяСсылки();
//		Если Объект.Родитель <> РодительСсылки Тогда
//			Если ЕстьВесовыеТовары() = Ложь Тогда
//				Возврат;			
//			КонецЕсли;	
//			ТекстВопроса = "ru = ""Внимание!
//			|При смене родителя будут удалены
//			|все привязки весового товара к текущим весам.
//			|Продолжить?""";
//			Ответ = Вопрос(НСтр(ТекстВопроса), РежимДиалогаВопрос.ДаНет, ,КодВозвратаДиалога.Нет);
//			Если Ответ = КодВозвратаДиалога.Нет Тогда
//				Отказ = Истина;
//				Возврат;
//			КонецЕсли;
//			УдалитьТовар();
//		КонецЕсли;	
//	КонецЕсли;	
//КонецПроцедуры

//&НаСервере
//Процедура УдалитьТовар()
//	Запрос = Новый Запрос;
//	Запрос.Текст = "
//	|ВЫБРАТЬ
//	|	ВесовойТовар.Ссылка
//	|ИЗ
//	|	Справочник.ВесовойТовар КАК ВесовойТовар
//	|ГДЕ
//	|	ВесовойТовар.Владелец = &Весы
//	|
//	|ДЛЯ ИЗМЕНЕНИЯ";
//	Запрос.УстановитьПараметр("Весы",Объект.Ссылка);
//	Выборка = Запрос.Выполнить().Выбрать();
//	Пока Выборка.Следующий() Цикл
//		Выборка.Ссылка.ПолучитьОбъект().Удалить();			
//	КонецЦикла;	
//КонецПроцедуры

//&НаСервере
//Функция ЕстьВесовыеТовары()
//	Выборка = Справочники.ВесовойТовар.Выбрать(,Объект.Ссылка);
//	Возврат Выборка.Следующий();
//КонецФункции

//&НаСервере
//Функция ПолучитьРодителяСсылки()
//	Возврат Объект.Ссылка.Родитель;
//КонецФункции
