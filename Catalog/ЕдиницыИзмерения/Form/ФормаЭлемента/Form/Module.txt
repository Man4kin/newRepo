
&НаКлиенте
Процедура ОбъектКартинкаПриИзменении(Элемент)
	// Вставить содержимое обработчика.
КонецПроцедуры

&НаКлиенте
Процедура ВыбратьКартинкуВыполнить()
	Перем ВыбранноеИмя;
	Перем АдресВременногоХранилища;
	НовыйОбъект = Объект.Ссылка.Пустая();
	Если ПоместитьФайл(АдресВременногоХранилища, "", ВыбранноеИмя, Истина, ЭтаФорма.УникальныйИдентификатор) Тогда
		АдресКартинки = ВыбранноеИмя;
		//ПоместитьФайлОбъекта(АдресВременногоХранилища);
		//Если НовыйОбъект Тогда
		//	ОтобразитьИзменениеДанных(Объект.Ссылка, ВидИзмененияДанных.Добавление);
		//КонецЕсли;			
	КонецЕсли;	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	//Отбор = ШК.Отбор.ЕдиницаИзмерения;
	//Отбор.Использование = Истина;
	//Отбор.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно;
	//Отбор.Значение = Объект.Ссылка;
	//Отбор = ШК.Отбор.Номенклатура;
	//Отбор.Использование = Истина;
	//Отбор.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно;
	//Отбор.Значение = Объект.Владелец;
	//ШК.Прочитать();
	//Набор = РегистрыСведений.ШтриховыеКоды.СоздатьНаборЗаписей();	
	//Набор.Отбор.ЕдиницаИзмерения.Установить(Объект.Ссылка);
	//Набор.Прочитать();
	//ШК.Загрузить(Набор.Выгрузить());
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
КонецПроцедуры

&НаКлиенте
Процедура ЕдиницаПоКлассификаторуПриИзменении(Элемент)
	Объект.Наименование = Объект.ЕдиницаПоКлассификатору;
	ЕдиницаПоКлассификаторуПриИзмененииНаСервере();
КонецПроцедуры

&НаСервере
Процедура ЕдиницаПоКлассификаторуПриИзмененииНаСервере()
	Коэффициент = 1;
	
	//ищем вниз от базовой единицы
	МладшаяЕдиница = Объект.Владелец.БазоваяЕдиницаИзмерения;
	Пока НЕ МладшаяЕдиница.Пустая() Цикл
		Если МладшаяЕдиница = Объект.ЕдиницаПоКлассификатору ИЛИ МладшаяЕдиница = МладшаяЕдиница.МладшаяЕдиница Тогда
			Прервать;
		КонецЕсли;	
		Коэффициент = Коэффициент*МладшаяЕдиница.Коэффициент;
		МладшаяЕдиница = МладшаяЕдиница.МладшаяЕдиница;
	КонецЦикла;
	//ищем вниз от выбранной единицы
	Если Коэффициент = 0 Тогда
		Коэффициент = 1;
		МладшаяЕдиница = Объект.ЕдиницаПоКлассификатору;
		Пока НЕ МладшаяЕдиница.Пустая() Цикл
			Если МладшаяЕдиница = Объект.Владелец.БазоваяЕдиницаИзмерения ИЛИ МладшаяЕдиница = МладшаяЕдиница.МладшаяЕдиница Тогда
				Прервать;
			КонецЕсли;	
			Коэффициент = Коэффициент*МладшаяЕдиница.Коэффициент;
			МладшаяЕдиница = МладшаяЕдиница.МладшаяЕдиница;
		КонецЦикла;
	КонецЕсли;
	Объект.Коэффициент = Коэффициент;
КонецПроцедуры



&НаСервере
Функция ПолучитьБазовуюЕдиницу()
	Возврат Объект.Владелец.БазоваяЕдиницаИзмерения;
КонецФункции

&НаСервере
Процедура ПриЗаписиНаСервере(Отказ, ТекущийОбъект)
	//Набор = РегистрыСведений.ШтриховыеКоды.СоздатьНаборЗаписей();	
	//Набор.Отбор.ЕдиницаИзмерения.Установить(ТекущийОбъект.Ссылка);
	//Таблица = ШК.Выгрузить();
	//Для Каждого Строка Из Таблица Цикл
	//	СтрокаНабора = Набор.Добавить();
	//	СтрокаНабора.Номенклатура = ТекущийОбъект.Владелец;
	//	СтрокаНабора.ЕдиницаИзмерения = ТекущийОбъект.Ссылка;
	//	СтрокаНабора.ШтрихКод = Строка.ШтрихКод;
	//КонецЦикла;
	//Набор.Записать();
КонецПроцедуры
