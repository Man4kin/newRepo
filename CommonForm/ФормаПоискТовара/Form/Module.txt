
&НаКлиенте
Процедура ОтменитьПоиск(Команда)
	Закрыть(Новый Структура("Действие", "ОтменитьПоиск"));
КонецПроцедуры

&НаКлиенте
Процедура НайтиНоменклатуру(Команда)
	
	Если ГдеИскать = "Код" Тогда
		Номенклатура = НайтиНоменклатуруПоКоду(ЧтоИскать);
	ИначеЕсли ГдеИскать = "Наименование" Тогда
		Номенклатура = НайтиНоменклатуруПоНаименованию(ЧтоИскать);
	ИначеЕсли ГдеИскать = "ШтрихКод" Тогда
		Номенклатура = НайтиНоменклатуруПоШКСервер(ЧтоИскать);
	Иначе
		Номенклатура = ПолучитьПустуюСсылку();
	КонецЕсли;
	
	Закрыть(Новый Структура("Действие, Номенклатура", "Найти", Номенклатура));
КонецПроцедуры

&НаСервере
Функция НайтиНоменклатуруПоКоду(Код)

	Возврат Справочники.Номенклатура.НайтиПоКоду(Код);

КонецФункции

&НаСервере
Функция НайтиНоменклатуруПоНаименованию(Наименование)

	//Запрос = Новый Запрос;
	//Запрос.Текст = "ВЫБРАТЬ ПЕРВЫЕ 1
	//			   |	Состав.Номенклатура
	//			   |ИЗ
	//			   |	&Состав КАК Состав
	//			   |ГДЕ
	//			   |	Состав.Номенклатура.Наименование ПОДОБНО &Наименование
	//			   |
	//			   |УПОРЯДОЧИТЬ ПО
	//			   |	Состав.НомерСтроки";
	//Запрос.УстановитьПараметр("Состав", Состав);
	//Запрос.Текст = 
	//	"ВЫБРАТЬ
	//	|	Номенклатура.Ссылка
	//	|ИЗ
	//	|	Справочник.Номенклатура КАК Номенклатура
	//	|ГДЕ
	//	|	Номенклатура.Группа = 0
	//	|	И Номенклатура.Транзакционный
	//	|	И Номенклатура.Наименование ПОДОБНО &Наименование";
	//
	//Запрос.УстановитьПараметр("Наименование", "%" + Наименование + "%");
	//
	//Возврат Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("Ссылка");
	//
	Возврат Справочники.Номенклатура.НайтиПоНаименованию(Наименование);

КонецФункции

&НаСервере
Функция НайтиНоменклатуруПоШКСервер(ШК)

	сткДанныеПоШК = ШтриховыеКоды.ПрочитатьШтрихкод(ШК);
	мНоменклатура = сткДанныеПоШК.мНоменклатура;
	Если мНоменклатура.Количество() = 0 Тогда
		Рез = Справочники.Номенклатура.ПустаяСсылка();
	Иначе
		Рез = мНоменклатура[0];
	КонецЕсли;
	
	Возврат Рез;

КонецФункции

&НаСервере
Функция ПолучитьПустуюСсылку()

	Возврат Справочники.Номенклатура.ПустаяСсылка();

КонецФункции

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	Если ПустаяСтрока(ГдеИскать) Тогда
		ГдеИскать = "Код";
	КонецЕсли;
	
КонецПроцедуры

