
// Процедура добавляет запись в регистр по переданным значениям структуры
Процедура ДобавитьЗапись(СтруктураЗаписи) Экспорт
	
	ОбменДаннымиРБДСервер.ДобавитьЗаписьВРегистрСведений(СтруктураЗаписи, "СостояниеОбменовДанными");
	
КонецПроцедуры

// Возвращает структуру с данными последнего обмена для заданного узла информационной базы и действия при обмене
//
// Параметры:
//  Нет.
// 
// Возвращаемое значение:
//  СостояниеОбменовДанными - Структура - структура с данными последнего обмена для заданного узла информационной базы
//
Функция СостояниеОбменовДанными(Знач УзелИнформационнойБазы, ДействиеПриОбмене) Экспорт
	
	// возвращаемое значение функции
	СостояниеОбменовДанными = Новый Структура;
	СостояниеОбменовДанными.Вставить("ДатаНачала");
	СостояниеОбменовДанными.Вставить("ДатаОкончания");
	
	ТекстЗапроса = "
	|ВЫБРАТЬ
	|	ДатаНачала,
	|	ДатаОкончания
	|ИЗ
	|	РегистрСведений.СостояниеОбменовДанными КАК СостояниеОбменовДанными
	|ГДЕ
	|	  СостояниеОбменовДанными.УзелИнформационнойБазы = &УзелИнформационнойБазы
	|	И СостояниеОбменовДанными.ДействиеПриОбмене      = &ДействиеПриОбмене
	|";
	
	Запрос = Новый Запрос;
	Запрос.Текст = ТекстЗапроса;
	Запрос.УстановитьПараметр("УзелИнформационнойБазы", УзелИнформационнойБазы);
	Запрос.УстановитьПараметр("ДействиеПриОбмене",      ДействиеПриОбмене);
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Если Выборка.Следующий() Тогда
		
		ЗаполнитьЗначенияСвойств(СостояниеОбменовДанными, Выборка);
		
	КонецЕсли;
	
	Возврат СостояниеОбменовДанными;
	
КонецФункции

