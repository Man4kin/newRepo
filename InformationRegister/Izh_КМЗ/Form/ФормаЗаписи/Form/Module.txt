&НаСервере
Процедура ЗаполнитьКатегориюНоменклатуры()
	Если ЗначениеЗаполнено(Запись.КатегорияНоменклатуры) Тогда
		КатегорияНоменклатуры = Справочники.Номенклатура.НайтиПоНаименованию(Запись.КатегорияНоменклатуры);
	КонецЕсли;		
КонецПроцедуры

&НаСервере
Процедура ПередЗаписьюНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)
	Если ЗначениеЗаполнено(КатегорияНоменклатуры) Тогда
		ТекущийОбъект.КатегорияНоменклатуры = КатегорияНоменклатуры.Наименование;
	Иначе
		ТекущийОбъект.КатегорияНоменклатуры = "";
	КонецЕсли;	
КонецПроцедуры

&НаКлиенте
Процедура КатегорияНоменклатурыОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;	
	Код = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(ВыбранноеЗначение, "Код");
	Если Найти(Код, "3:") > 0 Тогда
		КатегорияНоменклатуры = ВыбранноеЗначение;
		Запись.КатегорияНоменклатуры = ВыбранноеЗначение; 
	Иначе
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю(Строка(ВыбранноеЗначение) + " не является категорией!");
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	ЗаполнитьКатегориюНоменклатуры();
КонецПроцедуры
