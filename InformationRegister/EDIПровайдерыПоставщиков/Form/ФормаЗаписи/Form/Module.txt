
&НаСервере
Процедура ПередЗаписьюНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)
	Если Запись.Основной Тогда
		Запрос = Новый Запрос;
		Запрос.Текст = 
			"ВЫБРАТЬ
			|	EDIПровайдерыПоставщиков.EDIПровайдер,
			|	EDIПровайдерыПоставщиков.GLN
			|ИЗ
			|	РегистрСведений.EDIПровайдерыПоставщиков КАК EDIПровайдерыПоставщиков
			|ГДЕ
			|	EDIПровайдерыПоставщиков.Контрагент = &Контрагент
			|	И EDIПровайдерыПоставщиков.EDIПровайдер <> &EDIПровайдер
			|	И EDIПровайдерыПоставщиков.Основной";

		Запрос.УстановитьПараметр("EDIПровайдер", Запись.EDIПровайдер);
		Запрос.УстановитьПараметр("Контрагент", Запись.Контрагент);

		Результат = Запрос.Выполнить();

		ВыборкаДетальныеЗаписи = Результат.Выбрать();

		Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
			ЗаписьСтарая = РегистрыСведений.EDIПровайдерыПоставщиков.СоздатьМенеджерЗаписи();
			ЗаписьСтарая.Контрагент = Запись.Контрагент;
			ЗаписьСтарая.EDIПровайдер = ВыборкаДетальныеЗаписи.EDIПровайдер;
			ЗаписьСтарая.GLN = ВыборкаДетальныеЗаписи.GLN;
			ЗаписьСтарая.Основной = Ложь;
			ЗаписьСтарая.Записать();
		КонецЦикла;
	КонецЕсли;	
КонецПроцедуры
